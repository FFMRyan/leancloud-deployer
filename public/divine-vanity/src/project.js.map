{"version":3,"sources":["project.js"],"names":["require","e","t","n","r","s","o","u","a","i","f","Error","code","l","exports","call","length","AssetMng","module","cc","_RFpush","Class","extends","Component","properties","init","cb","this","wishesDB","url","raw","loader","loadJson","error","data","id","bind","getWishInfo","_RFpop","AudioMng","bgm","default","AudioClip","ritual","baby","wishSFX","statics","instance","playBGM","audioEngine","playMusic","playRitual","playEffect","playBaby","playWishSFX","wishType","onLoad","BattlePanel","PowerBar","EffectMng","people","type","Label","power","skillList","Node","skills","allUnlocked","start","instantiate","unlockBtn","state","self","eventManager","addListener","event","EventListener","KEYBOARD","onKeyPressed","keyCode","KEY","b","node","useSkill","skillID","costValue","emit","Resources","spendPower","chackBtnState","play","resources","len","skill","button","interactable","cost","curPower","firstPosX","current","active","x","unlocked","push","skillArr","getChildren","skillInfo","getComponent","updateSkill","ButtonScaler","pressedScale","transDuration","onTouchDown","stopAllActions","runAction","scaleDownAction","onTouchUp","scaleUpAction","initScale","scale","Button","scaleTo","on","Camera","editor","executeInEditMode","playOnFocus","previewOnFocus","notify","enabled","tooltip","editorOnly","world","onFocusInEditor","onLostFocusInEditor","onDisable","position","Vec2","ZERO","ONE","rotation","CC_EDITOR","engine","isPlaying","repaintInEditMode","lateUpdate","dt","screenCenter","Canvas","sub","scaleX","offset","subSelf","mulSelf","add","rotate","RAD","fxRain","ParticleSystem","fxMeta","fxFire","Animation","fxSun","fxWheat","resetSystem","update","FXRitual","particle","anim","sign","signID","playAnim","camera","find","lookAt","target","action","sequence","delayTime","playParticle","show","FXSign","sprite","Sprite","sfSigns","SpriteFrame","spriteFrame","opacity","_sgNode","fadeIn","scaleDown","callback","callFunc","wait","scheduleOnce","fadeOut","FXWonder","idx","y","random0To1","GameOverPanel","society","eyesAnimCtrl","hasDown","stopPropagation","onEnable","goToMainPanelClick","director","loadScene","God","battlePanel","wonderPrefab","Prefab","wonderLayer","skillFired","tribute","value","addPower","detail","showWonder","wonder","addChild","randomMinus1To1","Group","randomArrayItems","arr","num","temp","index","results","arrIndex","Math","floor","random","splice","unuse","reuse","js","mixin","prototype","States","DEFAULT","wish","poses","praying","prayRitual","countdown","learning","addMember","newbie","canLearn","ritualNeed","isLearning","isPraying","split","learningGroup","need","ceil","leftCount","person","toState","_this","PRAYING","rituals","forEach","behavior","currentState","currentWish","currentPose","pose","pray","poseDuration","LEARNING","UnusedPoses","poseCount","sort","lastX","moveTo","WORSHIPING","lostCount","array","tributePerP","lostCoef","LOST","lost","punish","rejointDefault","_this2","checked","poseId","prevPose","indexOf","prayCoef","behaviors","../../ykl/global","HumanBehavior","firstRight","firstWrong","visible","displayName","stop","WishType","wishIcon","sfWishIcons","wishIconAnim","window","oldState","_updateState","moveSpeed","idleMoveSpeed","idleChangeDirectionTimeRange","v2","canvas","_idleTime","_idleChangeDirectionTime","hideWish","DOUBTING","showWish","playLine","CONFIRMING","getChildByName","str","string","easing","easeOut","removeFromParent","onChecked","nar","handleDefaultState","range","direction","speed","width","currentClip","name","HumanManager","checkedHumans","onHumanIconClicked","break","item","setTimeout","updateHumanState","updateHumanPosition","human","minDistance","dif","first","close","left","right","j","second","abs","addCheckedHuman","checkedHuman","LookAt","requireComponent","_getWorldPosition","convertToWorldSpaceAR","scene","getRunningScene","convertToNodeSpaceAR","_setWorldPosition","pos","parent","src","dest","convertToNodeSpace","addSelf","delta","magSqr","maxDelta","dir","divSelf","sqrt","MainPanel","Society","Narrative","animCtrl","eyesNode","startGameBtn","battlePanelAnim","narrative","hasMoveScene","getScene","hideMainPanelAnimEnd","resume","runMoveScene","getAnimationState","wrapMode","WrapMode","Reverse","label","durationPerLine","textContents","multiline","fadeDuration","currentTextId","actFadeOut","actFadeIn","switchText","seq","hideLine","content","changePower","newPowerValue","newPowerBarValue","curValue","progress","curProgressValue","updateValue","barValue","addorLower","parseFloat","toFixed","animaBar","Skills",1,2,3,4,5,6,7,8,9,"INIT_POWER","MIN_POWER","MAX_POWER","Integer","gameOver","SkillMng","Skill","sfIcons","cooldown","userSkill","onButtonCooldown","createRitual","count","level","Wish","wishTypeList","Enum","getList","Wishes","PopulationLevel","Levels","wishes","host","fxRitual","assetMng","prayDelay","learnDelay","population","pause","_pause","ritualCount","lastRitualID","firstWishPop","god","defaultGroup","runningGroups","prayTimeout","learnTimeout","wishInfo","parseInt","divineConsume","wishConsume","levelBonus","attraction","wishCheck","group","wishID","pickedPose","max","poseID","Poses","ritualLearnt","newbies","round","generate","lastLevel","updatePopulation","newSkillsAvailable","startLearning","learn","delay","succeed","Object","keys","pool","putInPool","knownWishes","hasObject","getFromPool","../Wish","TriggerAnimEvent","startBtnAnim","eyesAnimEnd","generator","w","winSize","zIndex","height","global","Rain","Fire","Meat","Sun","Wheet"],"mappings":"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","file":"project.js","sourcesContent":["require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({\"AssetMng\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, 'b181bc2SmNOeJf9tXPf0Dt7', 'AssetMng');\n// scripts/controllers/AssetMng.js\n\ncc.Class({\n    \"extends\": cc.Component,\n\n    properties: {},\n\n    // use this for initialization\n    init: function init(cb) {\n        this.wishesDB = {};\n        var url = cc.url.raw('data/wishes.json');\n        cc.loader.loadJson(url, (function (error, data) {\n            for (var i = 0; i < data.length; ++i) {\n                if (data[i].id === \"\") break;\n                this.wishesDB[data[i].id] = data[i];\n            }\n            if (cb) {\n                cb();\n            }\n        }).bind(this));\n    },\n\n    getWishInfo: function getWishInfo(id) {\n        return this.wishesDB[id];\n    }\n\n});\n// called every frame, uncomment this function to activate update callback\n// update: function (dt) {\n\n// },\n\ncc._RFpop();\n},{}],\"AudioMng\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, 'e266aPgsu1L1LkzuRdVBhos', 'AudioMng');\n// scripts/controllers/AudioMng.js\n\nvar AudioMng = cc.Class({\n    \"extends\": cc.Component,\n\n    properties: {\n        bgm: {\n            \"default\": null,\n            url: cc.AudioClip\n        },\n        ritual: {\n            \"default\": null,\n            url: cc.AudioClip\n        },\n        baby: {\n            \"default\": null,\n            url: cc.AudioClip\n        },\n        wishSFX: {\n            \"default\": [],\n            url: cc.AudioClip\n        }\n    },\n\n    statics: {\n        instance: null\n    },\n\n    playBGM: function playBGM() {\n        cc.audioEngine.playMusic(this.bgm, true);\n    },\n\n    playRitual: function playRitual() {\n        cc.audioEngine.playEffect(this.ritual, false);\n    },\n\n    playBaby: function playBaby() {\n        cc.audioEngine.playEffect(this.baby, false);\n    },\n\n    playWishSFX: function playWishSFX(wishType) {\n        if (wishType < this.wishSFX.length) {\n            cc.audioEngine.playEffect(this.wishSFX[wishType], false);\n        }\n    },\n\n    onLoad: function onLoad() {\n        AudioMng.instance = this;\n    }\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n\ncc._RFpop();\n},{}],\"BattlePanel\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '9692anGBoVDu6ZC8ZqgzCSt', 'BattlePanel');\n// scripts/ui/BattlePanel.js\n\n\nvar PowerBar = require('PowerBar');\nvar EffectMng = require('EffectMng');\nvar AudioMng = require('AudioMng');\n\nvar BattlePanel = cc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        people: {\n            'default': null,\n            type: cc.Label\n        },\n        power: {\n            'default': null,\n            type: PowerBar\n        },\n        skillList: {\n            'default': null,\n            type: cc.Node\n        }\n    },\n\n    statics: {\n        instance: null\n    },\n\n    onLoad: function onLoad() {\n        BattlePanel.instance = this;\n        this.skills = [];\n        this.allUnlocked = false;\n    },\n\n    start: function start() {\n        this.instantiate();\n        this.unlockBtn(0);\n\n        this.state = 0;\n        var self = this;\n        cc.eventManager.addListener({\n            event: cc.EventListener.KEYBOARD,\n            onKeyPressed: function onKeyPressed(keyCode, event) {\n                switch (keyCode) {\n                    case cc.KEY.b:\n                        self.state++;\n                        if (self.state > 2) {\n                            self.state = 0;\n                        }\n                        self.unlockBtn(self.state);\n                        break;\n                }\n            }\n        }, this.node);\n    },\n\n    useSkill: function useSkill(skillID, costValue) {\n        this.node.emit(\"skill-fired\", { \"skillID\": skillID });\n        var Resources = require('Resources');\n        Resources.instance.spendPower(costValue);\n        this.chackBtnState(Resources);\n        EffectMng.instance.play(skillID);\n        AudioMng.instance.playWishSFX(skillID);\n    },\n\n    // 按钮状态 是否禁用\n    chackBtnState: function chackBtnState(resources) {\n        for (var i = 0, len = this.skills.length; i < len; ++i) {\n            var skill = this.skills[i];\n            skill.button.interactable = skill.cost <= resources.instance.curPower;\n        }\n    },\n\n    unlockBtn: function unlockBtn(state) {\n        if (this.allUnlocked) {\n            return;\n        }\n        if (state > 3) {\n            this.allUnlocked = true;\n        }\n        var firstPosX = 200 - state * 100;\n        var current = 0,\n            i,\n            len,\n            skill;\n        for (i = 0, len = this.skills.length; i < len; ++i) {\n            // this.skills[i].node.active = false;\n            skill = this.skills[i];\n            if (skill.node.active) {\n                current = i;\n                skill.node.x = firstPosX + 100 * i;\n            } else {\n                break;\n            }\n        }\n        var unlocked = [];\n        for (i = current + 1; i <= state && i < this.skills.length; i++) {\n            skill = this.skills[i];\n            skill.node.x = firstPosX + 100 * i;\n            skill.node.active = true;\n            unlocked.push(i);\n        }\n        return unlocked;\n    },\n\n    instantiate: function instantiate() {\n        var Resources = require('Resources');\n        var skillArr = this.skillList.getChildren();\n        for (var i = 0, len = skillArr.length; i < len; ++i) {\n            var skillInfo = { id: i, cost: 10 * (i + 1) };\n            var skill = skillArr[i].getComponent('Skill');\n            skill.updateSkill(skillInfo, this.useSkill, this);\n            this.skills.push(skill);\n        }\n    }\n});\n\ncc._RFpop();\n},{\"AudioMng\":\"AudioMng\",\"EffectMng\":\"EffectMng\",\"PowerBar\":\"PowerBar\",\"Resources\":\"Resources\"}],\"ButtonScaler\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '108b2nVDh9IeZC26KkMkuCF', 'ButtonScaler');\n// scripts/ui/ButtonScaler.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        pressedScale: 1,\n        transDuration: 0\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {\n        var self = this;\n        self.initScale = this.node.scale;\n        self.button = self.getComponent(cc.Button);\n        self.scaleDownAction = cc.scaleTo(self.transDuration, self.pressedScale);\n        self.scaleUpAction = cc.scaleTo(self.transDuration, self.initScale);\n        function onTouchDown(event) {\n            this.stopAllActions();\n            this.runAction(self.scaleDownAction);\n        }\n        function onTouchUp(event) {\n            this.stopAllActions();\n            this.runAction(self.scaleUpAction);\n        }\n        this.node.on('touchstart', onTouchDown, this.node);\n        this.node.on('touchend', onTouchUp, this.node);\n        this.node.on('touchcancel', onTouchUp, this.node);\n    }\n});\n\ncc._RFpop();\n},{}],\"Camera\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '22060AdHZBObYbbs2Iygq7v', 'Camera');\n// scripts/utils/Camera.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    editor: {\n        executeInEditMode: false,\n        playOnFocus: true\n    },\n\n    properties: {\n        previewOnFocus: {\n            'default': true,\n            notify: function notify() {\n                this.enabled = this.previewOnFocus;\n            },\n            tooltip: 'Enable to preview in editor when you select the camera',\n            editorOnly: true\n        },\n\n        world: {\n            'default': null,\n            type: cc.Node,\n            tooltip: 'The root object which contains all the object rendering in camera.'\n        }\n\n    },\n\n    // ...\n    onFocusInEditor: /*CC_EDITOR &&*/function onFocusInEditor() {\n        if (this.previewOnFocus) {\n            this.enabled = true;\n        }\n    },\n\n    onLostFocusInEditor: /*CC_EDITOR &&*/function onLostFocusInEditor() {\n        this.enabled = false;\n    },\n\n    //onEnable () {\n    //    if (this.world) {\n    //        if ( !this.world.position.equals(cc.Vec2.ZERO) ) {\n    //            cc.error('The position of your camera\\'s world node should be (0, 0)');\n    //        }\n    //        if ( this.world.rotation !== 0 ) {\n    //            cc.error('The rotation of your camera\\'s world node should be 0');\n    //        }\n    //        if ( this.world.scaleX !== 1 || this.world.scaleY !== 1) {\n    //            cc.error('The scale of your camera\\'s world node should be 1');\n    //        }\n    //    }\n    //},\n\n    onDisable: function onDisable() {\n        // revert world's transform so that the editor's scene view can be reset\n        this.world.position = cc.Vec2.ZERO;\n        this.world.scale = cc.Vec2.ONE;\n        this.world.rotation = 0;\n\n        if (CC_EDITOR && !cc.engine.isPlaying) {\n            cc.engine.repaintInEditMode();\n        }\n    },\n\n    lateUpdate: function lateUpdate(dt) {\n        var node = this.node;\n        var world = this.world;\n        if (!world) {\n            return;\n        }\n        var screenCenter;\n        if (cc.Canvas.instance) {\n            screenCenter = cc.Canvas.instance.node.position;\n        }\n\n        // compute position\n        var position = screenCenter.sub(node.position);\n\n        // compute scale\n        var scale = node.scaleX;\n        var offset = position.subSelf(screenCenter);\n        offset.mulSelf(scale);\n        position = screenCenter.add(offset);\n\n        // compute rotation\n        var rotation = -node.rotation;\n        if (rotation !== 0) {\n            position = screenCenter.add(offset.rotate(-rotation * cc.RAD));\n        }\n\n        world.position = position;\n        world.rotation = rotation;\n        world.scale = scale;\n    }\n});\n\ncc._RFpop();\n},{}],\"EffectMng\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '3fd87b15V9E2qme/w2pc7n5', 'EffectMng');\n// scripts/utils/EffectMng.js\n\nvar EffectMng = cc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        fxRain: {\n            'default': null,\n            type: cc.ParticleSystem\n        },\n        fxMeta: {\n            'default': null,\n            type: cc.ParticleSystem\n        },\n        fxFire: {\n            'default': null,\n            type: cc.Animation\n        },\n        fxSun: {\n            'default': null,\n            type: cc.Animation\n        },\n        fxWheat: {\n            'default': null,\n            type: cc.Animation\n        }\n    },\n\n    statics: {\n        instance: null\n    },\n\n    onLoad: function onLoad() {\n        EffectMng.instance = this;\n    },\n\n    play: function play(skillID) {\n        switch (skillID) {\n            case 0:\n                // 水\n                this.fxRain.enabled = true;\n                this.fxRain.resetSystem();\n                break;\n            case 1:\n                // 火\n                this.fxFire.play('fx_lightning');\n                break;\n            case 2:\n                // 肉\n                this.fxMeta.enabled = true;\n                this.fxMeta.resetSystem();\n                break;\n            case 3:\n                // 阳光\n                this.fxSun.play('fx_sun');\n                break;\n            case 4:\n                // 麦子\n                this.fxFire.play('fx_wheat');\n                break;\n        }\n    },\n\n    update: function update(dt) {}\n});\n\ncc._RFpop();\n},{}],\"FXRitual\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '0af8dguiAxB0as1d79lEyxj', 'FXRitual');\n// scripts/ui/FXRitual.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        particle: cc.ParticleSystem,\n        anim: cc.Animation,\n        sign: cc.Node\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {\n        this.sign = this.sign.getComponent('FXSign');\n        this.signID = -1;\n    },\n\n    playAnim: function playAnim(signID) {\n        this.signID = signID;\n        this.anim.play('play_ritual');\n\n        var camera = cc.find('Camera');\n        var lookAt = cc.find('Camera').getComponent('LookAt');\n\n        lookAt.target = this.node;\n\n        var action = cc.sequence([cc.scaleTo(0.5, 1.5, 1.5), cc.delayTime(2), cc.scaleTo(0.5, 1, 1)]);\n        camera.runAction(action);\n    },\n\n    playParticle: function playParticle() {\n        this.particle.resetSystem();\n        this.sign.show(this.signID);\n    }\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n\ncc._RFpop();\n},{}],\"FXSign\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '1490347bspGKKclhTzReMQy', 'FXSign');\n// scripts/ui/FXSign.js\n\ncc.Class({\n    \"extends\": cc.Component,\n\n    properties: {\n        sprite: cc.Sprite,\n        sfSigns: [cc.SpriteFrame]\n    },\n\n    onLoad: function onLoad() {\n        this.sprite.enabled = false;\n    },\n\n    show: function show(signID) {\n        this.sprite.enabled = true;\n        this.sprite.spriteFrame = this.sfSigns[signID];\n        this.node.scale = 3;\n        this.node.opacity = 0;\n        this.sprite._sgNode.opacity = 255;\n        var fadeIn = cc.fadeIn(0.3);\n        var scaleDown = cc.scaleTo(0.5, 1);\n        var callback = cc.callFunc(this.wait, this);\n        this.node.runAction(cc.sequence(fadeIn, scaleDown, callback));\n    },\n\n    wait: function wait() {\n        this.scheduleOnce(function () {\n            var fadeOut = cc.fadeOut(0.5);\n            this.node.runAction(fadeOut);\n        }, 1.5);\n    }\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n\ncc._RFpop();\n},{}],\"FXWonder\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '6b42fw35dNH+7eMDuukZfc0', 'FXWonder');\n// scripts/ui/FXWonder.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        particle: cc.ParticleSystem,\n        anim: cc.Animation\n    },\n\n    playAnim: function playAnim(idx) {\n        switch (idx) {\n            case 0:\n                this.anim.play('pop');\n                this.node.y -= cc.random0To1() * 80;\n                this.node.scale *= cc.random0To1() * 0.3 + 1;\n                break;\n            case 1:\n                this.anim.play('empty');\n                this.node.y += cc.random0To1() * 100;\n                break;\n            case 2:\n                this.anim.play('pop_maya');\n                this.node.y += cc.random0To1() * 60;\n                this.node.scale *= cc.random0To1() * 0.3 + 1;\n                break;\n            case 3:\n                this.anim.play('pop_egypt');\n                this.node.y += cc.random0To1() * 80;\n                break;\n            case 4:\n                this.anim.play('pop');\n                break;\n        }\n        // this.anim.play('pop');\n        this.particle.resetSystem();\n    }\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n\ncc._RFpop();\n},{}],\"GameOverPanel\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '630b5AQpM9A9bBwXOhRrRZD', 'GameOverPanel');\n// scripts/ui/GameOverPanel.js\n\ncc.Class({\n    \"extends\": cc.Component,\n\n    properties: {\n        society: {\n            \"default\": null,\n            type: cc.Node\n        },\n        eyesAnimCtrl: {\n            \"default\": null,\n            type: cc.Animation\n        }\n    },\n\n    onLoad: function onLoad() {\n        this.hasDown = false;\n        this.node.active = false;\n        this.node.on(\"touchstart\", function (event) {\n            event.stopPropagation();\n        });\n    },\n\n    onEnable: function onEnable() {\n        this.eyesAnimCtrl.play('hideEyes');\n    },\n\n    goToMainPanelClick: function goToMainPanelClick() {\n        if (this.hasDown) {\n            return;\n        }\n        this.hasDown = true;\n        cc.director.loadScene(\"game\");\n    }\n});\n\ncc._RFpop();\n},{}],\"God\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '8d8488GNe5KUoYdFG5att29', 'God');\n// scripts/controllers/God.js\n\nvar BattlePanel = require('BattlePanel');\nvar Resources = require('Resources');\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        battlePanel: {\n            'default': null,\n            type: cc.Node\n        },\n\n        resources: {\n            'default': null,\n            type: Resources\n        },\n\n        wonderPrefab: {\n            'default': null,\n            type: cc.Prefab\n        },\n\n        wonderLayer: cc.Node\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {\n        this.skills = this.node.getComponent('Skills');\n        this.society = this.node.getComponent('Society');\n\n        this.battlePanel.on('skill-fired', this.skillFired, this);\n    },\n\n    tribute: function tribute(value) {\n        this.resources.addPower(value);\n    },\n\n    skillFired: function skillFired(data) {\n        this.society.skillFired(data.detail.skillID);\n    },\n\n    showWonder: function showWonder(id) {\n        var wonder = cc.instantiate(this.wonderPrefab);\n        this.wonderLayer.addChild(wonder);\n        wonder.x = cc.randomMinus1To1() * 350;\n        wonder.getComponent('FXWonder').playAnim(id);\n    }\n});\n\ncc._RFpop();\n},{\"BattlePanel\":\"BattlePanel\",\"Resources\":\"Resources\"}],\"Group\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '244bdNcVplFa7OuEr2uSOgH', 'Group');\n// scripts/controllers/Group.js\n\nrequire('../../ykl/global');\n\nfunction randomArrayItems(arr, num) {\n    var temp = [];\n    for (var index in arr) {\n        temp.push(arr[index]);\n    }\n\n    var results = [];\n    for (var i = 0; i < num; i++) {\n        if (temp.length > 0) {\n            var arrIndex = Math.floor(Math.random() * temp.length);\n            results[i] = temp[arrIndex];\n            temp.splice(arrIndex, 1);\n        } else {\n            break;\n        }\n    }\n    return results;\n}\n\nvar Group = function Group(society) {\n    this.people = [];\n    this.unuse();\n    this.reuse(society);\n};\n\ncc.js.mixin(Group.prototype, {\n    unuse: function unuse() {\n        this.society = null;\n        this.people.length = 0;\n        this.state = States.DEFAULT;\n        this.wish = null;\n        this.poses = null;\n        this.praying = false;\n        this.prayRitual = null;\n        this.countdown = 0;\n        this.active = false;\n        this.learning = false;\n    },\n\n    reuse: function reuse(society) {\n        this.society = society;\n        this.active = true;\n    },\n\n    addMember: function addMember(newbie) {\n        if (this.state === States.DEFAULT) {\n            this.people.push(newbie);\n        }\n    },\n\n    canLearn: function canLearn(wish) {\n        return this.state === States.DEFAULT && this.people.length >= wish.ritualNeed;\n    },\n\n    isLearning: function isLearning() {\n        return this.learning === true;\n    },\n\n    isPraying: function isPraying() {\n        return this.praying === true;\n    },\n\n    split: function split(wish, learningGroup) {\n        if (this.canLearn(wish)) {\n            var need = wish.ritualNeed + Math.ceil(Math.random() * 2);\n            var leftCount = this.people.length - need;\n            leftCount < 0 && (leftCount = 0);\n            for (var i = this.people.length - 1; i >= leftCount; --i) {\n                var person = this.people.splice(i, 1);\n                learningGroup.addMember(person[0]);\n            }\n            return true;\n        }\n        return false;\n    },\n\n    toState: function toState(state, detail) {\n        var _this = this;\n\n        if (state !== this.state) {\n            this.state = state;\n            switch (state) {\n                case States.PRAYING:\n                    var ritual = this.society.rituals[this.wish.id];\n                    this.people.forEach(function (person, index) {\n                        var behavior = person.getComponent('HumanBehavior');\n                        behavior.currentState = States.PRAYING;\n                        behavior.currentWish = _this.wish;\n                        behavior.currentPose = ritual.pose;\n                        behavior.pray.getComponent(cc.Sprite).enabled = true;\n                        behavior.pray.play('pray');\n                    });\n                    this.countdown = this.wish.poseDuration;\n                    this.prayRitual = ritual.pose;\n                    this.praying = true;\n                    break;\n                case States.LEARNING:\n                    // Init learning\n                    this.poses = randomArrayItems(UnusedPoses, this.wish.poseCount);\n                    this.people.forEach(function (person, index) {\n                        var behavior = person.getComponent('HumanBehavior');\n                        behavior.currentState = States.LEARNING;\n                        behavior.currentWish = _this.wish;\n                        behavior.currentPose = _this.poses[index % _this.poses.length];\n                    });\n\n                    // 当 people 间距太小时，将 间距做一定调整\n                    var people = this.people.sort(function (a, b) {\n                        return a.x > b.x ? 1 : -1;\n                    });\n\n                    var lastX = null;\n                    for (var i = 0, l = people.length; i < l; i++) {\n                        if (i === 0) {\n                            lastX = people[i].x;\n                            continue;\n                        }\n\n                        var x = people[i].x;\n\n                        if (x - lastX < 50) {\n                            people[i].runAction(cc.moveTo(0.3, lastX + 50, people[i].y));\n                            lastX += 50;\n                        } else {\n                            lastX = x;\n                        }\n                    }\n\n                    this.countdown = this.wish.poseDuration;\n                    this.learning = true;\n                    break;\n                case States.WORSHIPING:\n                    // Not learning anymore\n                    this.poses && (this.poses.length = 0);\n                    var wish = this.wish;\n                    var people = this.people;\n                    var society = this.society;\n                    var praying = this.praying;\n                    var self = this;\n                    this.society.scheduleOnce(function () {\n                        var lostCount = 0;\n                        var array = [];\n                        people.forEach(function (person, index) {\n                            var behavior = person.getComponent('HumanBehavior');\n                            // Correct pose\n                            if (praying || detail === behavior.currentPose) {\n                                behavior.tribute = wish.tributePerP;\n                                behavior.currentState = States.WORSHIPING;\n                                array.push(person);\n                            }\n                            // Incorrect\n                            else {\n                                    if (Math.random() < society.lostCoef) {\n                                        var behavior = person.getComponent('HumanBehavior');\n                                        behavior.currentState = States.LOST;\n                                        lostCount++;\n                                    } else {\n                                        behavior.currentState = States.DEFAULT;\n                                        array.push(person);\n                                    }\n                                }\n                        });\n                        self.people = array;\n                        if (lostCount > 0) {\n                            society.lost(lostCount);\n                        }\n                    }, 0);\n                    this.wish = null;\n                    if (this.isLearning) {\n                        this.countdown = 4.5;\n                    } else {\n                        this.countdown = 2;\n                    }\n                    break;\n            }\n        }\n    },\n\n    punish: function punish() {\n        var people = this.people;\n        var society = this.society;\n        var self = this;\n        this.society.scheduleOnce(function () {\n            var lostCount = 0;\n            var array = [];\n            people.forEach(function (person, index) {\n                if (Math.random() < society.lostCoef) {\n                    lostCount++;\n                    var behavior = person.getComponent('HumanBehavior');\n                    behavior.currentState = States.LOST;\n                } else {\n                    array.push(person);\n                    person.getComponent('HumanBehavior').currentState = States.DEFAULT;\n                }\n            });\n            self.people = array;\n            if (lostCount > 0) {\n                society.lost(lostCount);\n            }\n            society.rejointDefault(self);\n        }, 0);\n        this.active = false;\n        this.state = States.DEFAULT;\n    },\n\n    update: function update(dt) {\n        var _this2 = this;\n\n        if (this.countdown > 0) {\n            this.countdown -= dt;\n        } else {\n            this.countdown = 0;\n            switch (this.state) {\n                case States.LEARNING:\n                    // Switch pose\n                    this.people.forEach(function (person) {\n                        var behavior = person.getComponent('HumanBehavior');\n                        if (!behavior.checked) {\n                            var prevPose = _this2.poses.indexOf(behavior.currentPose),\n                                poseId;\n                            do {\n                                poseId = Math.floor(Math.random() * _this2.poses.length);\n                            } while (poseId === prevPose && _this2.poses.length > 1);\n                            behavior.currentPose = _this2.poses[poseId];\n                        }\n                    });\n                    this.countdown = this.wish.poseDuration;\n                    break;\n                case States.PRAYING:\n                    var people = this.people;\n                    var society = this.society;\n                    var self = this;\n                    this.society.scheduleOnce(function () {\n                        var lostCount = 0;\n                        var array = [];\n                        people.forEach(function (person, index) {\n                            if (Math.random() < society.prayCoef) {\n                                lostCount++;\n                                var behavior = person.getComponent('HumanBehavior');\n                                behavior.currentState = States.LOST;\n                            } else {\n                                array.push(person);\n                                person.getComponent('HumanBehavior').currentState = States.DEFAULT;\n                            }\n                        });\n                        self.people = array;\n                        if (lostCount > 0) {\n                            society.lost(lostCount);\n                        }\n                        society.rejointDefault(self);\n                    }, 0);\n                    this.active = false;\n                    this.state = States.DEFAULT;\n                    break;\n                case States.WORSHIPING:\n                    var behaviors = [];\n                    this.people.forEach(function (person) {\n                        var behavior = person.getComponent('HumanBehavior');\n                        behaviors.push(behavior);\n                    });\n                    this.society.scheduleOnce(function () {\n                        for (var i = 0; i < behaviors.length; ++i) {\n                            behaviors[i].currentState = States.DEFAULT;\n                        }\n                    }, 0);\n                    this.state = States.DEFAULT;\n                    this.society.rejointDefault(this);\n                    break;\n            }\n        }\n    }\n});\n\nmodule.exports = Group;\n\ncc._RFpop();\n},{\"../../ykl/global\":\"global\"}],\"HumanBehavior\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, 'fd410vTg3VKQbu9IoKPzDA9', 'HumanBehavior');\n// ykl/HumanBehavior.js\n\nvar firstRight = false;\nvar firstWrong = false;\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        anim: {\n            'default': null,\n            type: cc.Animation\n        },\n\n        currentPose: {\n            visible: false,\n            'default': '',\n            displayName: '当前姿势',\n            notify: function notify() {\n                //if (CC_EDITOR) return;\n\n                // 播动画\n                this.anim.stop();\n                this.anim.play(this.currentPose);\n\n                // 做其他事情\n            }\n        },\n\n        currentWish: {\n            visible: false,\n            'default': '',\n            displayName: '当前愿望',\n            notify: function notify() {\n                //if (CC_EDITOR) return;\n\n                var name = WishType[this.currentWish.id];\n                this.wishIcon.getComponent(cc.Sprite).spriteFrame = this.sfWishIcons[this.currentWish.id];\n                this.wishIconAnim.play('show');\n            }\n        },\n\n        currentState: {\n            visible: false,\n            'default': window.States.DEFAULT,\n            notify: function notify(oldState) {\n                this._updateState(oldState);\n            }\n        },\n\n        wishIcon: {\n            'default': null,\n            type: cc.Node\n        },\n\n        wishIconAnim: {\n            'default': null,\n            type: cc.Animation\n        },\n\n        sfWishIcons: [cc.SpriteFrame],\n\n        pray: cc.Animation,\n\n        moveSpeed: 300,\n\n        idleMoveSpeed: 50,\n\n        idleChangeDirectionTimeRange: cc.v2(2, 4)\n    },\n\n    onLoad: function onLoad() {\n        this.checked = false;\n        this.canvas = cc.find('Canvas');\n\n        this._idleTime = this._idleChangeDirectionTime = 3;\n\n        this._updateState();\n    },\n\n    _updateState: function _updateState(oldState) {\n        var state = this.currentState;\n        if (oldState === window.States.PRAYING) {\n            this.pray.getComponent(cc.Sprite).enabled = false;\n        }\n\n        if (state === window.States.DEFAULT) {\n            this.hideWish();\n            this.anim.play('idle');\n            this.checked = false;\n        } else if (state === window.States.LEARNING) {\n            if (oldState !== window.States.DOUBTING) {\n                this.showWish();\n            }\n            this.wishIcon.getComponent(cc.Button).interactable = true;\n        } else if (state === window.States.DOUBTING) {\n            if (firstWrong === false) {\n                firstWrong = true;\n                cc.find('Canvas/world/narrative').getComponent('Narrative').playLine(4);\n            }\n            // 头上显示问号\n            this.wishIconAnim.play('doubt');\n        } else if (state === window.States.CONFIRMING) {\n            this.hideWish();\n            // 头上有问号\n            // this.anim.play('confirming');\n        } else if (state === window.States.WORSHIPING) {\n                // 头上无问号，播放跪拜动画\n                this.hideWish();\n                var tribute = this.node.getChildByName('tribute');\n                var str = '+' + this.tribute;\n                tribute.active = true;\n                tribute.getComponent(cc.Label).string = str;\n                tribute.runAction(cc.sequence(cc.moveTo(1, 0, 120), cc.callFunc(function () {\n                    tribute.y = 80;\n                    tribute.active = false;\n                })).easing(cc.easeOut(2)));\n                // this.anim.play('p_act03');\n            } else if (state === window.States.LOST) {\n                    // 丢失或是死掉\n                    this.anim.play('die');\n                    this.node.runAction(cc.sequence(cc.fadeOut(2.5), cc.callFunc(function () {\n                        this.node.removeFromParent();\n                    }, this)));\n                }\n    },\n\n    onChecked: function onChecked() {\n        var _this = this;\n\n        if (this.currentState !== window.States.LEARNING) {\n            return;\n        }\n        if (firstRight === false) {\n            (function () {\n                firstRight = true;\n                var nar = cc.find('Canvas/world/narrative').getComponent('Narrative');\n                _this.scheduleOnce(function () {\n                    nar.playLine(3);\n                }, 1);\n            })();\n        }\n        this.checked = true;\n        this.wishIcon.getComponent(cc.Button).interactable = false;\n        this.wishIconAnim.play('confirm');\n\n        this.canvas.emit('wish-clicked', this);\n    },\n\n    showWish: function showWish() {\n        this.wishIcon.stopAllActions();\n        this.wishIcon.active = true;\n        this.wishIcon.runAction(cc.moveTo(0.2, 0, 120));\n    },\n\n    hideWish: function hideWish() {\n        this.wishIcon.x = this.wishIcon.y = 0;\n        this.wishIcon.active = false;\n    },\n\n    update: function update(dt) {\n        if (this.currentState === window.States.DEFAULT) {\n            this.handleDefaultState(dt);\n        }\n    },\n\n    handleDefaultState: function handleDefaultState(dt) {\n        this._idleTime += dt;\n        if (this._idleTime > this._idleChangeDirectionTime) {\n            this._idleTime = 0;\n\n            var range = this.idleChangeDirectionTimeRange;\n            this._idleChangeDirectionTime = range.x + Math.random() * (range.y - range.x);\n\n            var direction = Math.floor(Math.random() * 2);\n            this.idleMoveSpeed *= direction === 0 ? -1 : 1;\n        }\n\n        var speed = this.idleMoveSpeed * dt;\n        var x = this.node.x + speed;\n        var width = this.canvas.width;\n\n        if (x <= 0 || x >= width) {\n            this.idleMoveSpeed *= -1;\n            x = this.node.x - speed;\n        }\n\n        if (this.idleMoveSpeed < 0 && this.anim.currentClip.name !== 'idle-left') {\n            this.anim.play('idle-left');\n        } else if (this.idleMoveSpeed > 0 && this.anim.currentClip.name !== 'idle') {\n            this.anim.play('idle');\n        }\n\n        this.node.x = x;\n    }\n});\n\ncc._RFpop();\n},{}],\"HumanManager\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '88808PpqTxP1LWq3PyX3Lux', 'HumanManager');\n// ykl/HumanManager.js\n\nvar HumanBehavior = require('HumanBehavior');\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {},\n\n    onLoad: function onLoad() {\n        // 已经被点击了的人类\n        this.checkedHumans = [];\n\n        var canvas = cc.find('Canvas');\n        canvas.on('wish-clicked', this.onHumanIconClicked, this);\n    },\n\n    'break': function _break() {\n        this.checkedHumans.forEach(function (item) {\n            (function (item) {\n                item.checked = false;\n                item.currentState = window.States.DOUBTING;\n\n                setTimeout(function () {\n                    item.currentState = window.States.LEARNING;\n                }, 500);\n            })(item);\n        });\n\n        this.checkedHumans = [];\n    },\n\n    update: function update(dt) {\n        this.updateHumanState();\n        this.updateHumanPosition(dt);\n    },\n\n    updateHumanState: function updateHumanState() {\n        var checkedHumans = this.checkedHumans;\n        for (var i = checkedHumans.length - 1; i >= 0; i--) {\n            var human = checkedHumans[i];\n\n            if (!human.checked) {\n                checkedHumans.splice(i, 1);\n            }\n        }\n    },\n\n    updateHumanPosition: function updateHumanPosition(dt) {\n        var checkedHumans = this.checkedHumans;\n        var length = checkedHumans.length;\n\n        if (length < 2) {\n            return;\n        }\n\n        var minDistance = 50;\n        var speed = checkedHumans[0].moveSpeed * dt;\n\n        for (var i = 0; i < length; i++) {\n            var first = checkedHumans[i];\n            var x = first.node.x;\n            var close = false;\n            var left = 0;\n            var right = 0;\n            var dif;\n\n            for (var j = 0; j < length; j++) {\n                var second = checkedHumans[j];\n                if (second === first) {\n                    continue;\n                }\n\n                dif = x - second.node.x;\n                if (Math.abs(dif) < minDistance) {\n                    close = true;\n                    break;\n                }\n\n                if (dif > 0) {\n                    left++;\n                } else {\n                    right++;\n                }\n            }\n\n            if (close) {\n                continue;\n            }\n\n            first.node.x += left > right ? -speed : speed;\n        }\n    },\n\n    addCheckedHuman: function addCheckedHuman(checkedHuman) {\n        var checkedHumans = this.checkedHumans;\n\n        if (checkedHumans.indexOf(checkedHuman) !== -1) {\n            return;\n        }\n\n        checkedHumans.push(checkedHuman);\n\n        if (checkedHumans.length > 1 && (checkedHuman.currentWish !== checkedHumans[0].currentWish || checkedHuman.currentPose !== checkedHumans[0].currentPose)) {\n            checkedHuman.checked = false;\n            this['break']();\n        }\n    },\n\n    onHumanIconClicked: function onHumanIconClicked(event) {\n        this.addCheckedHuman(event.detail);\n    }\n});\n\ncc._RFpop();\n},{\"HumanBehavior\":\"HumanBehavior\"}],\"LookAt\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '39182EXa1tHJpBfpeWWiLtq', 'LookAt');\n// scripts/utils/LookAt.js\n\ncc.Class({\n    'extends': cc.Component,\n    editor: {\n        executeInEditMode: true,\n        requireComponent: require('Camera')\n    },\n    properties: {\n        target: {\n            'default': null,\n            type: cc.Node,\n            tooltip: 'The target object to look at'\n        },\n        offset: {\n            'default': cc.Vec2.ZERO\n        },\n        speed: {\n            'default': 100,\n            tooltip: 'The max moving speed in world units per second'\n        }\n        //padding: {\n        //    default: 20,\n        //    tooltip: 'The distance in pixels between target object and the edge of screen'\n        //}\n    },\n\n    onLoad: function onLoad() {\n        this.camera = this.getComponent('Camera');\n    },\n\n    _getWorldPosition: function _getWorldPosition(node) {\n        var world = node.convertToWorldSpaceAR(cc.Vec2.ZERO);\n        var scene = cc.director.getRunningScene();\n        if (scene) {\n            return scene.convertToNodeSpaceAR(world);\n        } else {\n            return world;\n        }\n    },\n\n    _setWorldPosition: function _setWorldPosition(node, pos) {\n        var scene = cc.director.getRunningScene();\n        if (scene) {\n            pos = cc.v2(scene.convertToWorldSpaceAR(pos));\n        }\n        if (node.parent) {\n            node.position = node.parent.convertToNodeSpaceAR(pos);\n        } else {\n            node.position = pos;\n        }\n    },\n\n    lateUpdate: function lateUpdate(dt) {\n        if (!this.target) {\n            return;\n        }\n        if (!this.camera) {\n            return;\n        }\n\n        var src = this._getWorldPosition(this.node);\n        // get world position which not transformed by camera\n        var dest = this.target.convertToWorldSpaceAR(cc.Vec2.ZERO);\n        dest = this.camera.world.convertToNodeSpace(dest);\n        //\n        dest.addSelf(this.offset);\n\n        var delta = dest.sub(src);\n        var magSqr = delta.magSqr();\n        var maxDelta = this.speed * dt;\n\n        var pos;\n        if (magSqr <= maxDelta * maxDelta) {\n            pos = dest;\n        } else {\n            // tween\n            var dir = delta.divSelf(Math.sqrt(magSqr));\n            pos = src.addSelf(dir.mulSelf(maxDelta));\n        }\n\n        this._setWorldPosition(this.node, pos);\n    }\n});\n\ncc._RFpop();\n},{\"Camera\":\"Camera\"}],\"MainPanel\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '80017cfF89LOofh4s3wykhT', 'MainPanel');\n// scripts/ui/MainPanel.js\n\n\nvar Society = require('Society');\nvar AudioMng = require('AudioMng');\nvar Narrative = require('Narrative');\n\nvar MainPanel = cc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        society: {\n            'default': null,\n            type: Society\n        },\n        animCtrl: {\n            'default': null,\n            type: cc.Animation\n        },\n        eyesNode: {\n            'default': null,\n            type: cc.Node\n        },\n        startGameBtn: {\n            'default': null,\n            type: cc.Animation\n        },\n        battlePanelAnim: {\n            'default': null,\n            type: cc.Animation\n        },\n        narrative: Narrative\n    },\n\n    onLoad: function onLoad() {\n        this.hasMoveScene = false;\n        var scene = cc.director.getScene();\n        scene.y = -1450;\n        this.narrative.playLine(0);\n    },\n\n    hideMainPanelAnimEnd: function hideMainPanelAnimEnd() {\n        this.society.resume();\n        this.battlePanelAnim.play('showBattlePanel');\n    },\n\n    runMoveScene: function runMoveScene() {\n        var state = this.startGameBtn.getAnimationState('fadeInStartBtn');\n        state.wrapMode = cc.WrapMode.Reverse;\n        AudioMng.instance.playBGM();\n        this.society.narrative.playLine(1);\n        this.startGameBtn.play('fadeInStartBtn');\n        this.hasMoveScene = true;\n    },\n\n    update: function update(dt) {\n        if (this.hasMoveScene) {\n            var scene = cc.director.getScene();\n            if (scene.y >= 0) {\n                return;\n            }\n            scene.y += 300 * dt;\n            this.eyesNode.y -= 300 * dt;\n            if (scene.y > 0) {\n                scene.y = 0;\n                this.hasMoveScene = false;\n                this.animCtrl.play('hideMainPanel');\n            }\n        }\n    }\n\n});\n\ncc._RFpop();\n},{\"AudioMng\":\"AudioMng\",\"Narrative\":\"Narrative\",\"Society\":\"Society\"}],\"Narrative\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '0c78c7VGApJq6AlYoc9hlfy', 'Narrative');\n// scripts/ui/Narrative.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        label: cc.Label,\n        durationPerLine: 0,\n        textContents: {\n            'default': [],\n            type: 'String',\n            multiline: true\n        },\n        fadeDuration: 0\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {\n        this.currentTextId = 0;\n        this.node.opacity = 0;\n        // let idx = 0;\n        // this.schedule(function() {\n        //     this.playLine(idx);\n        //     idx++;\n        // }.bind(this), this.durationPerLine, 4, 0);\n    },\n\n    playLine: function playLine(idx) {\n        this.currentTextId = idx;\n        var actFadeOut = cc.fadeOut(this.fadeDuration);\n        var actFadeIn = cc.fadeIn(this.fadeDuration);\n        var callback = cc.callFunc(this.switchText, this);\n        var seq = cc.sequence(actFadeOut, callback, actFadeIn);\n        this.node.runAction(seq);\n        if (idx === 4 || idx === 3) {\n            this.scheduleOnce(function () {\n                this.hideLine();\n            }, 3);\n        }\n    },\n\n    hideLine: function hideLine() {\n        this.node.runAction(cc.fadeOut(2));\n    },\n\n    switchText: function switchText() {\n        this.label.string = this.textContents[this.currentTextId];\n    }\n\n});\n// called every frame, uncomment this function to activate update callback\n// update: function (dt) {\n\n// },\n\ncc._RFpop();\n},{}],\"PowerBar\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '63e23/x1P1DHajbaVkXJyIp', 'PowerBar');\n// scripts/ui/PowerBar.js\n\nvar PowerBar = cc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        content: {\n            'default': null,\n            type: cc.Label\n        }\n    },\n\n    onLoad: function onLoad() {\n        this.power = this.getComponent('cc.ProgressBar');\n        this.changePower = false;\n        this.newPowerValue = 0;\n        this.newPowerBarValue = 0;\n        this.addPower = 0;\n        this.curValue = this.power.progress * 100;\n        this.curProgressValue = 0;\n    },\n\n    updateValue: function updateValue(value, barValue, addorLower) {\n        this.changePower = true;\n        this.newPowerValue = value;\n        this.newPowerBarValue = barValue;\n        this.curProgressValue = parseFloat(this.power.progress.toFixed(2));\n        this.addPower = this.newPowerBarValue >= this.curProgressValue ? 1 : -1;\n    },\n\n    animaBar: function animaBar() {\n        if (this.changePower) {\n            this.curProgressValue = parseFloat(this.power.progress.toFixed(2));\n            if (this.curProgressValue !== this.newPowerBarValue) {\n                this.power.progress += 0.01 * this.addPower;\n            }\n            if (this.curValue !== this.newPowerValue) {\n                this.curValue += 1 * this.addPower;\n                this.content.string = this.curValue;\n            }\n            if (this.curProgressValue == this.newPowerBarValue && this.curValue === this.newPowerValue) {\n                this.changePower = false;\n            }\n        }\n    },\n\n    update: function update(dt) {\n        this.animaBar();\n    }\n});\n\ncc._RFpop();\n},{}],\"Resources\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '52a728YXuFIjIT4uiKYa6dO', 'Resources');\n// scripts/controllers/Resources.js\n\n\nvar BattlePanel = require('BattlePanel');\nvar GameOverPanel = require('GameOverPanel');\n\nvar Skills = {\n    0: \"雨|\" + 5,\n    1: \"火|\" + 10,\n    2: \"肉|\" + 15,\n    3: \"健康|\" + 20,\n    4: \"阳光|\" + 25,\n    5: \"谷物|\" + 30,\n    6: \"矿藏|\" + 35,\n    7: \"武器|\" + 40,\n    8: \"燃料|\" + 45,\n    9: \"绿色植物|\" + 50\n};\n\nvar INIT_POWER = 20;\nvar MIN_POWER = 0;\nvar MAX_POWER = 100;\n\nvar Resources = cc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        curPower: {\n            'default': 0,\n            type: cc.Integer,\n            visible: false\n        },\n\n        gameOver: {\n            'default': null,\n            type: GameOverPanel\n        }\n    },\n\n    statics: {\n        instance: null\n    },\n\n    onLoad: function onLoad() {\n        Resources.instance = this;\n    },\n\n    start: function start() {\n        this.curPower = 0;\n        this.addPower(INIT_POWER);\n    },\n\n    // 增加能量\n    addPower: function addPower(value) {\n        this.curPower += value;\n        this.curPower = this.curPower >= MAX_POWER ? MAX_POWER : this.curPower;\n        BattlePanel.instance.power.updateValue(this.curPower, this.curPower / Resources.MAX_POWER);\n    },\n\n    // 减能量\n    spendPower: function spendPower(value) {\n        this.curPower -= value;\n        this.curPower = this.curPower <= MIN_POWER ? MIN_POWER : this.curPower;\n        BattlePanel.instance.power.updateValue(this.curPower, this.curPower / Resources.MAX_POWER);\n\n        this.scheduleOnce(function () {\n            if (this.curPower < 10) {\n                this.gameOver.node.active = true;\n            }\n        }, 5);\n    }\n});\n\nResources.MIN_POWER = MIN_POWER;\nResources.MAX_POWER = MAX_POWER;\nResources.Skills = Skills;\n\ncc._RFpop();\n},{\"BattlePanel\":\"BattlePanel\",\"GameOverPanel\":\"GameOverPanel\"}],\"SkillMng\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, 'ea87fcJKItLaqsfUPzHz3Xx', 'SkillMng');\n// scripts/controllers/SkillMng.js\n\ncc.Class({\n    \"extends\": cc.Component,\n\n    properties: {\n        // foo: {\n        //    default: null,\n        //    url: cc.Texture2D,  // optional, default is typeof default\n        //    serializable: true, // optional, default is true\n        //    visible: true,      // optional, default is true\n        //    displayName: 'Foo', // optional\n        //    readonly: false,    // optional, default is false\n        // },\n        // ...\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {}\n\n});\n// called every frame, uncomment this function to activate update callback\n// update: function (dt) {\n\n// },\n\ncc._RFpop();\n},{}],\"Skill\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, 'b874brCF5xOxoY39iXDY0fK', 'Skill');\n// scripts/ui/Skill.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        label: cc.Label,\n        sprite: cc.Sprite,\n        sfIcons: [cc.SpriteFrame],\n        skillID: {\n            'default': 0,\n            type: cc.Integer,\n            visible: false\n        },\n        cost: {\n            'default': 0,\n            type: cc.Integer,\n            visible: false\n        },\n        button: cc.Button,\n        cooldown: 0\n    },\n\n    userSkill: function userSkill() {\n        if (this.callback) {\n            this.callback.call(this.target, this.skillID, this.cost);\n            this.button.interactable = false;\n            this.scheduleOnce(this.onButtonCooldown.bind(this), this.cooldown);\n        }\n    },\n\n    onButtonCooldown: function onButtonCooldown() {\n        var Resources = require('Resources');\n        if (this.cost > Resources.instance.curPower) {\n            return;\n        }\n        this.button.interactable = true;\n    },\n\n    updateSkill: function updateSkill(skillInfo, callback, target) {\n        this.skillID = skillInfo.id;\n        this.cost = skillInfo.cost;\n        this.label.string = this.cost;\n        this.sprite.spriteFrame = this.sfIcons[this.skillID];\n        this.callback = callback;\n        this.target = target;\n    }\n});\n\ncc._RFpop();\n},{\"Resources\":\"Resources\"}],\"Society\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '07354aU81JPS5ESw2HLIjGo', 'Society');\n// scripts/controllers/Society.js\n\nrequire('../../ykl/global');\nvar Group = require('Group');\nvar Wish = require('../Wish');\nvar BattlePanel = require('BattlePanel');\nvar FXRitual = require('FXRitual');\nvar GameOverPanel = require('GameOverPanel');\nvar AssetMng = require('AssetMng');\nvar AudioMng = require('AudioMng');\nvar Narrative = require('Narrative');\n\nvar wishTypeList = cc.Enum.getList(WishType);\nvar Wishes = {};\nvar PopulationLevel = [3, 8, 20, 35, 50];\nvar Levels = {};\nfor (var i = 0; i < wishTypeList.length; ++i) {\n    var id = wishTypeList[i].value;\n    Wishes[id] = new Wish();\n    Wishes[id].id = id;\n    Levels[PopulationLevel[i]] = id;\n}\n\nfunction createRitual(pose, id) {\n    return {\n        id: id,\n        pose: pose,\n        count: 0,\n        level: 0\n    };\n}\n\nvar Society = cc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        // Unlearnt Wishes\n        wishes: {\n            'default': [],\n            type: [Wish]\n        },\n\n        // Root node to host all people\n        host: {\n            'default': null,\n            type: cc.Node\n        },\n\n        battlePanel: {\n            'default': null,\n            type: BattlePanel\n        },\n\n        fxRitual: {\n            'default': null,\n            type: FXRitual\n        },\n\n        gameOver: {\n            'default': null,\n            type: GameOverPanel\n        },\n\n        assetMng: {\n            'default': null,\n            type: AssetMng\n        },\n\n        narrative: Narrative,\n\n        // Decide when to ask\n        prayDelay: 20,\n\n        // Decide the possibility to lost people\n        lostCoef: 1,\n\n        prayCoef: 0.3,\n\n        // Decide when to learn, +- 1 floating\n        learnDelay: 10,\n\n        // Population\n        population: 0\n    },\n\n    pause: function pause() {\n        this._pause = true;\n        this.node.emit('pause');\n    },\n\n    resume: function resume() {\n        this._pause = false;\n        this.node.emit('resume');\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {\n        this.rituals = {};\n        this.ritualCount = 0;\n        this.lastRitualID = 0;\n\n        this.firstWishPop = false;\n\n        this._pause = true;\n\n        this.god = this.getComponent('God');\n\n        // People who do nothing\n        this.defaultGroup = new Group(this);\n        // People who is learning the learningSkill\n        this.learningGroup = new Group(this);\n        // All running groups which is not in default state\n        this.runningGroups = [];\n\n        this.prayTimeout = this.prayDelay;\n        this.learnTimeout = this.learnDelay;\n\n        // AudioMng.instance.playBGM();\n\n        this.assetMng.init((function () {\n            for (var i = 0; i < wishTypeList.length; ++i) {\n                var id = wishTypeList[i].value;\n                var wishInfo = this.assetMng.wishesDB[id];\n                Wishes[id].poseCount = parseInt(wishInfo.poseCount);\n                Wishes[id].poseDuration = parseInt(wishInfo.poseDuration);\n                Wishes[id].moveSpeed = parseInt(wishInfo.moveSpeed);\n                Wishes[id].ritualNeed = parseInt(wishInfo.ritualNeed);\n                Wishes[id].tributePerP = parseInt(wishInfo.tributePerP);\n                Wishes[id].divineConsume = parseInt(wishInfo.divineConsume);\n                Wishes[id].wishConsume = parseInt(wishInfo.wishConsume);\n                Wishes[id].levelBonus = parseInt(wishInfo.levelBonus);\n                Wishes[id].attraction = parseInt(wishInfo.attraction);\n            }\n        }).bind(this));\n    },\n\n    wishCheck: function wishCheck(group, wishID) {\n        if (group.isLearning() && group.wish && group.wish.id === wishID) {\n            var i,\n                people = group.people,\n                poses = {},\n                behavior,\n                pose,\n                max = 1,\n                pickedPose;\n            for (i = 0; i < people.length; ++i) {\n                behavior = people[i].getComponent('HumanBehavior');\n                if (!behavior.checked) {\n                    continue;\n                }\n                pose = behavior.currentPose;\n                if (poses[pose]) {\n                    poses[pose]++;\n                    if (poses[pose] > max) {\n                        max = poses[pose];\n                        pickedPose = pose;\n                    }\n                } else {\n                    poses[pose] = 1;\n                }\n            }\n            // Ritual need satisfied\n            var wish = group.wish;\n            if (pickedPose && max >= wish.ritualNeed) {\n                this.scheduleOnce(function () {\n                    var poseID = Poses.indexOf(pickedPose);\n                    this.fxRitual.playAnim(poseID);\n                    // this.god.showWonder();\n                }, 2.5);\n                AudioMng.instance.playRitual();\n                this.ritualLearnt(wish, pickedPose);\n                this.tribute(max * wish.wishConsume, wish);\n                group.toState(States.WORSHIPING, pickedPose);\n            }\n        } else if (group.isPraying() && group.prayRitual === this.rituals[wishID].pose) {\n            this.tribute(group.people.length * Wishes[wishID].wishConsume, Wishes[wishID]);\n            group.toState(States.WORSHIPING);\n        } else if (group.wish) {\n            // Force update pose\n            group.punish();\n        }\n    },\n\n    skillFired: function skillFired(wishID) {\n        this.wishCheck(this.learningGroup, wishID);\n\n        for (var i = 0; i < this.runningGroups.length; ++i) {\n            var group = this.runningGroups[i];\n            this.wishCheck(group, wishID);\n        }\n    },\n\n    tribute: function tribute(resources, wish) {\n        this.god.tribute(resources);\n        var newbies = Math.round(wish.attraction + Math.random() * 2 - 1);\n        this.getComponent('generator').generate(newbies);\n        AudioMng.instance.playBaby();\n\n        // Upgrade rituals\n        var ritual = this.rituals[wish.id];\n        ritual.count++;\n        var lastLevel = ritual.level;\n        ritual.level = Math.floor(ritual.count / 3);\n        if (ritual.level > lastLevel) {\n            this.god.showWonder(ritual.id);\n        }\n    },\n\n    updatePopulation: function updatePopulation() {\n        this.battlePanel.people.string = this.population;\n        var max, count;\n        for (var i = 0; i < PopulationLevel.length; ++i) {\n            count = PopulationLevel[i];\n            if (this.population >= count && Levels[count]) {\n                max = count;\n                id = Levels[count];\n            } else if (this.population < count) {\n                break;\n            }\n        }\n        if (max) {\n            var unlocked = this.battlePanel.unlockBtn(Levels[max]);\n            unlocked && this.newSkillsAvailable(unlocked);\n        }\n    },\n\n    newSkillsAvailable: function newSkillsAvailable(skills) {\n        for (var i = 0; i < skills.length; ++i) {\n            var id = skills[i];\n            if (Wishes[id]) {\n                this.wishes.push(Wishes[id]);\n            }\n        }\n    },\n\n    startLearning: function startLearning() {\n        if (this.learningGroup.isLearning()) {\n            this.learningGroup.toState(States.LEARNING);\n        }\n    },\n\n    learn: function learn() {\n        if (this.firstWishPop === false) {\n            this.firstWishPop = true;\n            this.scheduleOnce(function () {\n                this.narrative.playLine(2);\n            }, 1);\n        }\n        for (var i = 0; i < this.wishes.length; ++i) {\n            var wish = this.wishes[i];\n            this.learningGroup.reuse(this);\n            var delay = 2 + Math.random() * 2;\n            var succeed = this.defaultGroup.split(wish, this.learningGroup);\n            if (succeed) {\n                this.learningGroup.wish = wish;\n                this.learningGroup.learning = true;\n                this.scheduleOnce(this.startLearning, delay);\n                break;\n            }\n        }\n    },\n\n    ritualLearnt: function ritualLearnt(wish, pose) {\n        this.rituals[wish.id] = createRitual(pose, this.lastRitualID);\n        this.lastRitualID++;\n        this.ritualCount = Object.keys(this.rituals).length;\n        this.prayTimeout = this.prayDelay;\n        var index = this.wishes.indexOf(wish);\n        if (index !== -1) {\n            this.wishes.splice(index, 1);\n        }\n        index = UnusedPoses.indexOf(pose);\n        if (index > -1) {\n            UnusedPoses.splice(index, 1);\n        }\n    },\n\n    rejointDefault: function rejointDefault(group) {\n        var defaultGroup = this.defaultGroup;\n        group.people.forEach(function (person) {\n            defaultGroup.addMember(person);\n        });\n        if (group === this.learningGroup) {\n            group.unuse();\n        } else {\n            var index = this.runningGroups.indexOf(group);\n            if (index >= 0) {\n                this.runningGroups.splice(index, 1);\n            }\n            cc.pool.putInPool(group);\n        }\n    },\n\n    lost: function lost(count) {\n        this.population -= count;\n        this.updatePopulation();\n        if (this.population < 3) {\n            this.gameOver.node.active = true;\n        }\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    update: function update(dt) {\n        if (this._pause) {\n            return;\n        }\n\n        // Learn new skill if possible\n        if (this.wishes.length > 0 && !this.learningGroup.learning) {\n            if (this.learnTimeout <= 0 || this.ritualCount === 0) {\n                this.learnTimeout = this.learnDelay;\n                this.learn();\n            }\n            this.learnTimeout -= dt;\n        }\n        if (this.learningGroup.active) {\n            this.learningGroup.update(dt);\n        }\n        // Pray with ritual\n        var group;\n        if (this.ritualCount > 0) {\n            // Ready for praying\n            if (this.prayTimeout <= 0) {\n                this.prayTimeout = this.prayDelay;\n                var knownWishes = Object.keys(this.rituals);\n                var wishID = knownWishes[Math.floor(Math.random() * knownWishes.length)];\n                var wish = Wishes[wishID];\n                group = cc.pool.hasObject(Group) ? cc.pool.getFromPool(Group) : new Group(this);\n                var succeed = this.defaultGroup.split(wish, group);\n                if (succeed) {\n                    group.wish = wish;\n                    group.praying = true;\n                    this.runningGroups.push(group);\n                    group.toState(States.PRAYING);\n                }\n            }\n            this.prayTimeout -= dt;\n        }\n\n        for (var i = 0; i < this.runningGroups.length; ++i) {\n            group = this.runningGroups[i];\n            if (group.active) {\n                group.update(dt);\n            }\n        }\n    }\n});\n\nSociety.Wishes = Wishes;\n\ncc._RFpop();\n},{\"../../ykl/global\":\"global\",\"../Wish\":\"Wish\",\"AssetMng\":\"AssetMng\",\"AudioMng\":\"AudioMng\",\"BattlePanel\":\"BattlePanel\",\"FXRitual\":\"FXRitual\",\"GameOverPanel\":\"GameOverPanel\",\"Group\":\"Group\",\"Narrative\":\"Narrative\"}],\"TriggerAnimEvent\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, 'd6b5bKEME1LdZrQDXO704qZ', 'TriggerAnimEvent');\n// scripts/utils/TriggerAnimEvent.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        startBtnAnim: {\n            'default': null,\n            type: cc.Animation\n        }\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {},\n\n    eyesAnimEnd: function eyesAnimEnd() {\n        this.startBtnAnim.play('fadeInStartBtn');\n    }\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n\ncc._RFpop();\n},{}],\"Wish\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, 'cd80bMwggpJGrAca2Y6vLoB', 'Wish');\n// scripts/Wish.js\n\nvar Wish = cc.Class({\n    name: 'Wish',\n    properties: {\n        id: 0,\n        poseCount: 2,\n        poseDuration: 3,\n        moveSpeed: 50,\n        ritualNeed: 3,\n        tributePerP: 2,\n        divineConsume: 1,\n        wishConsume: 3,\n        levelBonus: 0.1,\n        attraction: 1\n    }\n});\n\nmodule.exports = Wish;\n\ncc._RFpop();\n},{}],\"generator\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '7d32f/FDHZEMY1WZNTt3Lps', 'generator');\n// scripts/levels/generator.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        population: 3,\n\n        y: {\n            type: [cc.Integer],\n            'default': []\n        },\n\n        // Person prefab for generating people\n        person: {\n            'default': null,\n            type: cc.Prefab\n        }\n    },\n\n    // use this for initialization\n    start: function start() {\n        this.society = this.getComponent('Society');\n\n        if (!this.society._pause) {\n            this.generate(this.population);\n        } else {\n            this.society.node.on('resume', function () {\n                this.generate(this.population);\n            }, this);\n        }\n    },\n\n    generate: function generate(count) {\n        var society = this.society;\n        if (!society.host) {\n            return;\n        }\n        for (var i = 0; i < count; ++i) {\n            var newbie = cc.instantiate(this.person);\n            // Random between [50, width-100)\n            var w = cc.winSize.width;\n            newbie.x = w * 0.2 + Math.floor(Math.random() * w * 0.6) - 96;\n            newbie.y = this.y.length > 0 ? this.y[i % this.y.length] : 100;\n            var zIndex = cc.winSize.height - newbie.y;\n            newbie.opacity = 0;\n            newbie.runAction(cc.fadeIn(1));\n            society.host.addChild(newbie, zIndex);\n            society.defaultGroup.addMember(newbie);\n        }\n        society.population += count;\n        society.updatePopulation();\n    }\n});\n\ncc._RFpop();\n},{}],\"global\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '796dclFGDdGeoH9i6fiyI+J', 'global');\n// ykl/global.js\n\n\nvar States = cc.Enum({\n    DEFAULT: 0,\n    LEARNING: 1,\n    DOUBTING: 2,\n    CONFIRMING: 3,\n    WORSHIPING: 4,\n    PRAYING: 5,\n    LOST: 6\n});\n\nvar WishType = cc.Enum({\n    Rain: -1,\n    Fire: -1,\n    Meat: -1,\n    Sun: -1,\n    Wheet: -1\n});\n\nvar Poses = ['p_act01', 'p_act02', 'p_act03', 'p_act04', 'p_act05', 'p_act06', 'p_act07', 'p_act08'];\n\nvar UnusedPoses = ['p_act01', 'p_act02', 'p_act03', 'p_act04', 'p_act05', 'p_act06', 'p_act07', 'p_act08'];\n\nwindow.States = States;\nwindow.Poses = Poses;\nwindow.UnusedPoses = UnusedPoses;\nwindow.WishType = WishType;\n\ncc._RFpop();\n},{}]},{},[\"Society\",\"FXRitual\",\"Narrative\",\"ButtonScaler\",\"FXSign\",\"Camera\",\"Group\",\"LookAt\",\"Resources\",\"EffectMng\",\"FXWonder\",\"global\",\"generator\",\"MainPanel\",\"GameOverPanel\",\"PowerBar\",\"HumanManager\",\"BattlePanel\",\"God\",\"Skill\",\"AssetMng\",\"Wish\",\"TriggerAnimEvent\",\"AudioMng\",\"SkillMng\",\"HumanBehavior\"]);\n"],"sourceRoot":"/source/"}