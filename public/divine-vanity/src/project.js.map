{"version":3,"sources":["project.js"],"names":["require","e","t","n","r","s","o","u","a","i","f","Error","code","l","exports","call","length","AssetMng","module","cc","_RFpush","Class","extends","Component","properties","init","cb","this","wishesDB","url","raw","loader","loadJson","error","data","id","bind","getWishInfo","_RFpop","AudioMng","bgm","default","AudioClip","ritual","baby","wishSFX","statics","instance","playBGM","audioEngine","playMusic","playRitual","playEffect","playBaby","playWishSFX","wishType","onLoad","BattlePanel","PowerBar","EffectMng","Rituals","Credits","people","type","Label","power","skillList","Node","rituals","btnRituals","creditPanel","skills","allUnlocked","node","active","start","instantiate","unlockBtn","state","self","eventManager","addListener","event","EventListener","KEYBOARD","onKeyPressed","keyCode","KEY","b","useSkill","skillID","costValue","emit","Resources","spendPower","chackBtnState","play","resources","len","skill","button","interactable","cost","curPower","firstPosX","current","x","unlocked","push","showCredit","showRituals","skillArr","getChildren","skillInfo","getComponent","updateSkill","ButtonScaler","pressedScale","transDuration","onTouchDown","stopAllActions","runAction","scaleDownAction","onTouchUp","scaleUpAction","initScale","scale","Button","scaleTo","on","Camera","editor","executeInEditMode","playOnFocus","previewOnFocus","notify","enabled","tooltip","editorOnly","world","onFocusInEditor","onLostFocusInEditor","onDisable","position","Vec2","ZERO","ONE","rotation","lateUpdate","dt","screenCenter","Canvas","sub","scaleX","offset","subSelf","mulSelf","add","rotate","RAD","scrollView","ScrollView","startScroll","onEnable","isInit","scheduleOnce","scrollDown","scrollToBottom","hide","unschedule","update","scrollToTop","fxRain","ParticleSystem","fxMeta","fxFire","Animation","fxSun","fxWheat","resetSystem","FXRitual","particle","anim","sign","signID","playAnim","camera","find","lookAt","target","action","sequence","delayTime","playParticle","show","FXSign","sprite","Sprite","sfSigns","SpriteFrame","spriteFrame","opacity","_sgNode","fadeIn","scaleDown","callback","callFunc","wait","fadeOut","FXWonder","idx","y","random0To1","GameOverPanel","society","eyesAnimCtrl","hasDown","stopPropagation","goToMainPanelClick","director","loadScene","God","battlePanel","wonderPrefab","Prefab","wonderLayer","skillFired","tribute","value","addPower","detail","showWonder","wonder","addChild","randomMinus1To1","Group","randomArrayItems","arr","num","temp","index","results","arrIndex","Math","floor","random","splice","unuse","reuse","js","mixin","prototype","States","DEFAULT","wish","poses","praying","prayRitual","countdown","learning","addMember","newbie","canLearn","ritualNeed","isLearning","isPraying","split","learningGroup","need","ceil","leftCount","person","toState","_this","PRAYING","forEach","behavior","currentState","currentWish","currentPose","pose","pray","poseDuration","LEARNING","UnusedPoses","poseCount","sort","lastX","moveTo","WORSHIPING","lostCount","array","tributePerP","lostCoef","LOST","lost","punish","rejointDefault","_this2","checked","poseId","prevPose","indexOf","prayCoef","behaviors","../../ykl/global","HumanBehavior","firstRight","firstWrong","visible","displayName","stop","WishType","wishIcon","sfWishIcons","wishIconAnim","skillConfirm","window","oldState","_updateState","moveSpeed","idleMoveSpeed","idleChangeDirectionTimeRange","v2","canvas","getChildByName","_idleTime","_idleChangeDirectionTime","hideWish","showWish","DOUBTING","playLine","CONFIRMING","str","string","easing","easeOut","removeFromParent","onChecked","nar","handleDefaultState","range","direction","speed","width","currentClip","name","HumanManager","checkedHumans","onHumanIconClicked","break","item","setTimeout","updateHumanState","updateHumanPosition","human","minDistance","dif","first","close","left","right","j","second","abs","addCheckedHuman","checkedHuman","LookAt","requireComponent","_getWorldPosition","convertToWorldSpaceAR","scene","getRunningScene","convertToNodeSpaceAR","_setWorldPosition","pos","parent","src","dest","convertToNodeSpace","addSelf","delta","magSqr","maxDelta","dir","divSelf","sqrt","MainPanel","Society","Narrative","animCtrl","eyesNode","startGameBtn","battlePanelAnim","narrative","hasMoveScene","getScene","hideMainPanelAnimEnd","resume","runMoveScene","getAnimationState","wrapMode","WrapMode","Reverse","label","durationPerLine","textContents","multiline","fadeDuration","currentTextId","actFadeOut","actFadeIn","switchText","seq","hideLine","content","changePower","newPowerValue","newPowerBarValue","curValue","progress","curProgressValue","updateValue","barValue","addorLower","parseFloat","toFixed","animaBar","Skills",1,2,3,4,5,6,7,8,9,"INIT_POWER","MIN_POWER","MAX_POWER","Integer","gameOver","activateRitual","poseComp","Ritual","SkillMng","Skill","sfIcons","cooldown","userSkill","onButtonCooldown","createRitual","count","level","Wish","wishTypeList","Enum","getList","Wishes","PopulationLevel","Levels","wishes","host","fxRitual","assetMng","prayDelay","rollWishCoef","learnDelay","population","pause","_pause","ritualCount","lastRitualID","firstWishPop","_nextWish","god","defaultGroup","runningGroups","prayTimeout","learnTimeout","wishInfo","parseInt","divineConsume","wishConsume","levelBonus","attraction","wishCheck","group","wishID","pickedPose","max","poseID","Poses","ritualLearnt","newbies","round","generate","lastLevel","updatePopulation","newSkillsAvailable","startLearning","learn","delay","succeed","Object","keys","pool","putInPool","knownWishes","rand","unit","bouns","rolled","_i","hasObject","getFromPool","_i2","../Wish","TouchStart","mask","repeatForever","TOUCH_ONE_BY_ONE","onTouchBegan","touch","onTouchEnded","TriggerAnimEvent","startBtnAnim","startBtn","eyesAnimEnd","generator","w","winSize","zIndex","height","global","Rain","Fire","Meat","Sun","Wheet"],"mappings":"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","file":"project.js","sourcesContent":["require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({\"AssetMng\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, 'b181bc2SmNOeJf9tXPf0Dt7', 'AssetMng');\n// scripts/controllers/AssetMng.js\n\ncc.Class({\n    \"extends\": cc.Component,\n\n    properties: {},\n\n    // use this for initialization\n    init: function init(cb) {\n        this.wishesDB = {};\n        var url = cc.url.raw('data/wishes.json');\n        cc.loader.loadJson(url, (function (error, data) {\n            for (var i = 0; i < data.length; ++i) {\n                if (data[i].id === \"\") break;\n                this.wishesDB[data[i].id] = data[i];\n            }\n            if (cb) {\n                cb();\n            }\n        }).bind(this));\n    },\n\n    getWishInfo: function getWishInfo(id) {\n        return this.wishesDB[id];\n    }\n\n});\n// called every frame, uncomment this function to activate update callback\n// update: function (dt) {\n\n// },\n\ncc._RFpop();\n},{}],\"AudioMng\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, 'e266aPgsu1L1LkzuRdVBhos', 'AudioMng');\n// scripts/controllers/AudioMng.js\n\nvar AudioMng = cc.Class({\n    \"extends\": cc.Component,\n\n    properties: {\n        bgm: {\n            \"default\": null,\n            url: cc.AudioClip\n        },\n        ritual: {\n            \"default\": null,\n            url: cc.AudioClip\n        },\n        baby: {\n            \"default\": null,\n            url: cc.AudioClip\n        },\n        wishSFX: {\n            \"default\": [],\n            url: cc.AudioClip\n        }\n    },\n\n    statics: {\n        instance: null\n    },\n\n    playBGM: function playBGM() {\n        cc.audioEngine.playMusic(this.bgm, true);\n    },\n\n    playRitual: function playRitual() {\n        cc.audioEngine.playEffect(this.ritual, false);\n    },\n\n    playBaby: function playBaby() {\n        cc.audioEngine.playEffect(this.baby, false);\n    },\n\n    playWishSFX: function playWishSFX(wishType) {\n        if (wishType < this.wishSFX.length) {\n            cc.audioEngine.playEffect(this.wishSFX[wishType], false);\n        }\n    },\n\n    onLoad: function onLoad() {\n        AudioMng.instance = this;\n    }\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n\ncc._RFpop();\n},{}],\"BattlePanel\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '9692anGBoVDu6ZC8ZqgzCSt', 'BattlePanel');\n// scripts/ui/BattlePanel.js\n\n\nvar PowerBar = require('PowerBar');\nvar EffectMng = require('EffectMng');\nvar AudioMng = require('AudioMng');\nvar Rituals = require('Rituals');\nvar Credits = require('Credits');\n\nvar BattlePanel = cc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        people: {\n            'default': null,\n            type: cc.Label\n        },\n        power: {\n            'default': null,\n            type: PowerBar\n        },\n        skillList: {\n            'default': null,\n            type: cc.Node\n        },\n        rituals: {\n            'default': null,\n            type: Rituals\n        },\n        btnRituals: cc.Node,\n        creditPanel: Credits\n    },\n\n    statics: {\n        instance: null\n    },\n\n    onLoad: function onLoad() {\n        BattlePanel.instance = this;\n        this.skills = [];\n        this.allUnlocked = false;\n        this.creditPanel.node.active = false;\n    },\n\n    start: function start() {\n        this.instantiate();\n        this.unlockBtn(0);\n\n        this.state = 0;\n        var self = this;\n        cc.eventManager.addListener({\n            event: cc.EventListener.KEYBOARD,\n            onKeyPressed: function onKeyPressed(keyCode, event) {\n                switch (keyCode) {\n                    case cc.KEY.b:\n                        self.state++;\n                        if (self.state > 2) {\n                            self.state = 0;\n                        }\n                        self.unlockBtn(self.state);\n                        break;\n                }\n            }\n        }, this.node);\n    },\n\n    useSkill: function useSkill(skillID, costValue) {\n        this.node.emit(\"skill-fired\", { \"skillID\": skillID });\n        var Resources = require('Resources');\n        Resources.instance.spendPower(costValue);\n        this.chackBtnState(Resources);\n        EffectMng.instance.play(skillID);\n        AudioMng.instance.playWishSFX(skillID);\n    },\n\n    // 按钮状态 是否禁用\n    chackBtnState: function chackBtnState(resources) {\n        for (var i = 0, len = this.skills.length; i < len; ++i) {\n            var skill = this.skills[i];\n            skill.button.interactable = skill.cost <= resources.instance.curPower;\n        }\n    },\n\n    unlockBtn: function unlockBtn(state) {\n        if (this.allUnlocked) {\n            return;\n        }\n        if (state > 3) {\n            this.allUnlocked = true;\n        }\n        var firstPosX = 200 - state * 100;\n        var current = 0,\n            i,\n            len,\n            skill;\n        for (i = 0, len = this.skills.length; i < len; ++i) {\n            // this.skills[i].node.active = false;\n            skill = this.skills[i];\n            if (skill.node.active) {\n                current = i;\n                skill.node.x = firstPosX + 100 * i;\n            } else {\n                break;\n            }\n        }\n        var unlocked = [];\n        for (i = current + 1; i <= state && i < this.skills.length; i++) {\n            skill = this.skills[i];\n            skill.node.x = firstPosX + 100 * i;\n            skill.node.active = true;\n            unlocked.push(i);\n        }\n        return unlocked;\n    },\n\n    showCredit: function showCredit() {\n        if (!this.creditPanel.node.active) {\n            this.creditPanel.node.active = true;\n            // this.creditPanel.startScroll();\n        }\n    },\n\n    showRituals: function showRituals() {\n        if (!this.rituals.node.active) {\n            this.rituals.node.active = true;\n        }\n    },\n\n    instantiate: function instantiate() {\n        var Resources = require('Resources');\n        var skillArr = this.skillList.getChildren();\n        for (var i = 0, len = skillArr.length; i < len; ++i) {\n            var skillInfo = { id: i, cost: 10 * (i + 1) };\n            var skill = skillArr[i].getComponent('Skill');\n            skill.updateSkill(skillInfo, this.useSkill, this);\n            this.skills.push(skill);\n        }\n    }\n});\n\ncc._RFpop();\n},{\"AudioMng\":\"AudioMng\",\"Credits\":\"Credits\",\"EffectMng\":\"EffectMng\",\"PowerBar\":\"PowerBar\",\"Resources\":\"Resources\",\"Rituals\":\"Rituals\"}],\"ButtonScaler\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '108b2nVDh9IeZC26KkMkuCF', 'ButtonScaler');\n// scripts/ui/ButtonScaler.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        pressedScale: 1,\n        transDuration: 0\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {\n        var self = this;\n        self.initScale = this.node.scale;\n        self.button = self.getComponent(cc.Button);\n        self.scaleDownAction = cc.scaleTo(self.transDuration, self.pressedScale);\n        self.scaleUpAction = cc.scaleTo(self.transDuration, self.initScale);\n        function onTouchDown(event) {\n            this.stopAllActions();\n            this.runAction(self.scaleDownAction);\n        }\n        function onTouchUp(event) {\n            this.stopAllActions();\n            this.runAction(self.scaleUpAction);\n        }\n        this.node.on('touchstart', onTouchDown, this.node);\n        this.node.on('touchend', onTouchUp, this.node);\n        this.node.on('touchcancel', onTouchUp, this.node);\n    }\n});\n\ncc._RFpop();\n},{}],\"Camera\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '22060AdHZBObYbbs2Iygq7v', 'Camera');\n// scripts/utils/Camera.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    editor: {\n        executeInEditMode: false,\n        playOnFocus: true\n    },\n\n    properties: {\n        previewOnFocus: {\n            'default': true,\n            notify: function notify() {\n                this.enabled = this.previewOnFocus;\n            },\n            tooltip: 'Enable to preview in editor when you select the camera',\n            editorOnly: true\n        },\n\n        world: {\n            'default': null,\n            type: cc.Node,\n            tooltip: 'The root object which contains all the object rendering in camera.'\n        }\n\n    },\n\n    // ...\n    onFocusInEditor: /*CC_EDITOR &&*/function onFocusInEditor() {\n        if (this.previewOnFocus) {\n            this.enabled = true;\n        }\n    },\n\n    onLostFocusInEditor: /*CC_EDITOR &&*/function onLostFocusInEditor() {\n        this.enabled = false;\n    },\n\n    //onEnable () {\n    //    if (this.world) {\n    //        if ( !this.world.position.equals(cc.Vec2.ZERO) ) {\n    //            cc.error('The position of your camera\\'s world node should be (0, 0)');\n    //        }\n    //        if ( this.world.rotation !== 0 ) {\n    //            cc.error('The rotation of your camera\\'s world node should be 0');\n    //        }\n    //        if ( this.world.scaleX !== 1 || this.world.scaleY !== 1) {\n    //            cc.error('The scale of your camera\\'s world node should be 1');\n    //        }\n    //    }\n    //},\n\n    onDisable: function onDisable() {\n        // revert world's transform so that the editor's scene view can be reset\n        this.world.position = cc.Vec2.ZERO;\n        this.world.scale = cc.Vec2.ONE;\n        this.world.rotation = 0;\n\n        if (CC_EDITOR && !cc.engine.isPlaying) {\n            cc.engine.repaintInEditMode();\n        }\n    },\n\n    lateUpdate: function lateUpdate(dt) {\n        var node = this.node;\n        var world = this.world;\n        if (!world) {\n            return;\n        }\n        var screenCenter;\n        if (cc.Canvas.instance) {\n            screenCenter = cc.Canvas.instance.node.position;\n        }\n\n        // compute position\n        var position = screenCenter.sub(node.position);\n\n        // compute scale\n        var scale = node.scaleX;\n        var offset = position.subSelf(screenCenter);\n        offset.mulSelf(scale);\n        position = screenCenter.add(offset);\n\n        // compute rotation\n        var rotation = -node.rotation;\n        if (rotation !== 0) {\n            position = screenCenter.add(offset.rotate(-rotation * cc.RAD));\n        }\n\n        world.position = position;\n        world.rotation = rotation;\n        world.scale = scale;\n    }\n});\n\ncc._RFpop();\n},{}],\"Credits\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, 'fed9fSD5vpCTYgFzRSPmDsB', 'Credits');\n// scripts/ui/Credits.js\n\ncc.Class({\n    \"extends\": cc.Component,\n\n    properties: {\n        scrollView: cc.ScrollView\n    },\n\n    // use this for initialization\n    startScroll: function startScroll() {},\n\n    onEnable: function onEnable() {\n        this.isInit = true;\n        this.scheduleOnce(this.scrollDown, 2);\n    },\n\n    scrollDown: function scrollDown() {\n        this.scrollView.scrollToBottom(10, false);\n    },\n\n    hide: function hide() {\n        this.node.active = false;\n        this.unschedule(this.scrollDown);\n        this.isInit = true;\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    update: function update(dt) {\n        if (this.isInit) {\n            this.scrollView.scrollToTop();\n            this.isInit = false;\n        }\n    }\n});\n\ncc._RFpop();\n},{}],\"EffectMng\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '3fd87b15V9E2qme/w2pc7n5', 'EffectMng');\n// scripts/utils/EffectMng.js\n\nvar EffectMng = cc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        fxRain: {\n            'default': null,\n            type: cc.ParticleSystem\n        },\n        fxMeta: {\n            'default': null,\n            type: cc.ParticleSystem\n        },\n        fxFire: {\n            'default': null,\n            type: cc.Animation\n        },\n        fxSun: {\n            'default': null,\n            type: cc.Animation\n        },\n        fxWheat: {\n            'default': null,\n            type: cc.Animation\n        }\n    },\n\n    statics: {\n        instance: null\n    },\n\n    onLoad: function onLoad() {\n        EffectMng.instance = this;\n    },\n\n    play: function play(skillID) {\n        switch (skillID) {\n            case 0:\n                // 水\n                this.fxRain.enabled = true;\n                this.fxRain.resetSystem();\n                break;\n            case 1:\n                // 火\n                this.fxFire.play('fx_lightning');\n                break;\n            case 2:\n                // 肉\n                this.fxMeta.enabled = true;\n                this.fxMeta.resetSystem();\n                break;\n            case 3:\n                // 阳光\n                this.fxSun.play('fx_sun');\n                break;\n            case 4:\n                // 麦子\n                this.fxFire.play('fx_wheat');\n                break;\n        }\n    },\n\n    update: function update(dt) {}\n});\n\ncc._RFpop();\n},{}],\"FXRitual\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '0af8dguiAxB0as1d79lEyxj', 'FXRitual');\n// scripts/ui/FXRitual.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        particle: cc.ParticleSystem,\n        anim: cc.Animation,\n        sign: cc.Node\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {\n        this.sign = this.sign.getComponent('FXSign');\n        this.signID = -1;\n    },\n\n    playAnim: function playAnim(signID) {\n        this.signID = signID;\n        this.anim.play('play_ritual');\n\n        var camera = cc.find('Camera');\n        var lookAt = cc.find('Camera').getComponent('LookAt');\n\n        lookAt.target = this.node;\n\n        var action = cc.sequence([cc.scaleTo(0.5, 1.5, 1.5), cc.delayTime(2), cc.scaleTo(0.5, 1, 1)]);\n        camera.runAction(action);\n    },\n\n    playParticle: function playParticle() {\n        this.particle.resetSystem();\n        this.sign.show(this.signID);\n    }\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n\ncc._RFpop();\n},{}],\"FXSign\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '1490347bspGKKclhTzReMQy', 'FXSign');\n// scripts/ui/FXSign.js\n\ncc.Class({\n    \"extends\": cc.Component,\n\n    properties: {\n        sprite: cc.Sprite,\n        sfSigns: [cc.SpriteFrame]\n    },\n\n    onLoad: function onLoad() {\n        this.sprite.enabled = false;\n    },\n\n    show: function show(signID) {\n        this.sprite.enabled = true;\n        this.sprite.spriteFrame = this.sfSigns[signID];\n        this.node.scale = 3;\n        this.node.opacity = 0;\n        this.sprite._sgNode.opacity = 255;\n        var fadeIn = cc.fadeIn(0.3);\n        var scaleDown = cc.scaleTo(0.5, 1);\n        var callback = cc.callFunc(this.wait, this);\n        this.node.runAction(cc.sequence(fadeIn, scaleDown, callback));\n    },\n\n    wait: function wait() {\n        this.scheduleOnce(function () {\n            var fadeOut = cc.fadeOut(0.5);\n            this.node.runAction(fadeOut);\n        }, 1.5);\n    }\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n\ncc._RFpop();\n},{}],\"FXWonder\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '6b42fw35dNH+7eMDuukZfc0', 'FXWonder');\n// scripts/ui/FXWonder.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        particle: cc.ParticleSystem,\n        anim: cc.Animation\n    },\n\n    playAnim: function playAnim(idx) {\n        switch (idx) {\n            case 0:\n                this.anim.play('pop');\n                this.node.y -= cc.random0To1() * 80;\n                this.node.scale *= cc.random0To1() * 0.3 + 1;\n                break;\n            case 1:\n                this.anim.play('empty');\n                this.node.y += cc.random0To1() * 100;\n                break;\n            case 2:\n                this.anim.play('pop_maya');\n                this.node.y += cc.random0To1() * 30;\n                this.node.scale *= cc.random0To1() * 0.3 + 1;\n                break;\n            case 3:\n                this.anim.play('pop_egypt');\n                this.node.y += cc.random0To1() * 30;\n                break;\n            case 4:\n                this.anim.play('pop');\n                break;\n        }\n        // this.anim.play('pop');\n        this.particle.resetSystem();\n    }\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n\ncc._RFpop();\n},{}],\"GameOverPanel\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '630b5AQpM9A9bBwXOhRrRZD', 'GameOverPanel');\n// scripts/ui/GameOverPanel.js\n\ncc.Class({\n    \"extends\": cc.Component,\n\n    properties: {\n        society: {\n            \"default\": null,\n            type: cc.Node\n        },\n        eyesAnimCtrl: {\n            \"default\": null,\n            type: cc.Animation\n        }\n    },\n\n    onLoad: function onLoad() {\n        this.hasDown = false;\n        this.node.active = false;\n        this.node.on(\"touchstart\", function (event) {\n            event.stopPropagation();\n        });\n    },\n\n    onEnable: function onEnable() {\n        this.eyesAnimCtrl.play('hideEyes');\n    },\n\n    goToMainPanelClick: function goToMainPanelClick() {\n        if (this.hasDown) {\n            return;\n        }\n        this.hasDown = true;\n        cc.director.loadScene(\"game\");\n    }\n});\n\ncc._RFpop();\n},{}],\"God\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '8d8488GNe5KUoYdFG5att29', 'God');\n// scripts/controllers/God.js\n\nvar BattlePanel = require('BattlePanel');\nvar Resources = require('Resources');\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        battlePanel: {\n            'default': null,\n            type: cc.Node\n        },\n\n        resources: {\n            'default': null,\n            type: Resources\n        },\n\n        wonderPrefab: {\n            'default': null,\n            type: cc.Prefab\n        },\n\n        wonderLayer: cc.Node\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {\n        this.skills = this.node.getComponent('Skills');\n        this.society = this.node.getComponent('Society');\n\n        this.battlePanel.on('skill-fired', this.skillFired, this);\n    },\n\n    tribute: function tribute(value) {\n        this.resources.addPower(value);\n    },\n\n    skillFired: function skillFired(data) {\n        this.society.skillFired(data.detail.skillID);\n    },\n\n    showWonder: function showWonder(id) {\n        var wonder = cc.instantiate(this.wonderPrefab);\n        this.wonderLayer.addChild(wonder);\n        wonder.x = cc.randomMinus1To1() * 350;\n        wonder.getComponent('FXWonder').playAnim(id);\n    }\n});\n\ncc._RFpop();\n},{\"BattlePanel\":\"BattlePanel\",\"Resources\":\"Resources\"}],\"Group\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '244bdNcVplFa7OuEr2uSOgH', 'Group');\n// scripts/controllers/Group.js\n\nrequire('../../ykl/global');\n\nfunction randomArrayItems(arr, num) {\n    var temp = [];\n    for (var index in arr) {\n        temp.push(arr[index]);\n    }\n\n    var results = [];\n    for (var i = 0; i < num; i++) {\n        if (temp.length > 0) {\n            var arrIndex = Math.floor(Math.random() * temp.length);\n            results[i] = temp[arrIndex];\n            temp.splice(arrIndex, 1);\n        } else {\n            break;\n        }\n    }\n    return results;\n}\n\nvar Group = function Group(society) {\n    this.people = [];\n    this.unuse();\n    this.reuse(society);\n};\n\ncc.js.mixin(Group.prototype, {\n    unuse: function unuse() {\n        this.society = null;\n        this.people.length = 0;\n        this.state = States.DEFAULT;\n        this.wish = null;\n        this.poses = null;\n        this.praying = false;\n        this.prayRitual = null;\n        this.countdown = 0;\n        this.active = false;\n        this.learning = false;\n    },\n\n    reuse: function reuse(society) {\n        this.society = society;\n        this.active = true;\n    },\n\n    addMember: function addMember(newbie) {\n        if (this.state === States.DEFAULT) {\n            this.people.push(newbie);\n        }\n    },\n\n    canLearn: function canLearn(wish) {\n        return this.state === States.DEFAULT && this.people.length >= wish.ritualNeed;\n    },\n\n    isLearning: function isLearning() {\n        return this.learning === true;\n    },\n\n    isPraying: function isPraying() {\n        return this.praying === true;\n    },\n\n    split: function split(wish, learningGroup) {\n        if (this.canLearn(wish)) {\n            var need = wish.ritualNeed + Math.ceil(Math.random() * 2);\n            var leftCount = this.people.length - need;\n            leftCount < 0 && (leftCount = 0);\n            for (var i = this.people.length - 1; i >= leftCount; --i) {\n                var person = this.people.splice(i, 1);\n                learningGroup.addMember(person[0]);\n            }\n            return true;\n        }\n        return false;\n    },\n\n    toState: function toState(state, detail) {\n        var _this = this;\n\n        if (state !== this.state) {\n            this.state = state;\n            switch (state) {\n                case States.PRAYING:\n                    var ritual = this.society.rituals[this.wish.id];\n                    this.people.forEach(function (person, index) {\n                        var behavior = person.getComponent('HumanBehavior');\n                        behavior.currentState = States.PRAYING;\n                        behavior.currentWish = _this.wish;\n                        behavior.currentPose = ritual.pose;\n                        behavior.pray.getComponent(cc.Sprite).enabled = true;\n                        behavior.pray.play('pray');\n                    });\n                    this.countdown = this.wish.poseDuration;\n                    this.prayRitual = ritual.pose;\n                    this.praying = true;\n                    break;\n                case States.LEARNING:\n                    // Init learning\n                    this.poses = randomArrayItems(UnusedPoses, this.wish.poseCount);\n                    this.people.forEach(function (person, index) {\n                        var behavior = person.getComponent('HumanBehavior');\n                        behavior.currentState = States.LEARNING;\n                        behavior.currentWish = _this.wish;\n                        behavior.currentPose = _this.poses[index % _this.poses.length];\n                    });\n\n                    // 当 people 间距太小时，将 间距做一定调整\n                    var people = this.people.sort(function (a, b) {\n                        return a.x > b.x ? 1 : -1;\n                    });\n\n                    var lastX = null;\n                    for (var i = 0, l = people.length; i < l; i++) {\n                        if (i === 0) {\n                            lastX = people[i].x;\n                            continue;\n                        }\n\n                        var x = people[i].x;\n\n                        if (x - lastX < 50) {\n                            people[i].runAction(cc.moveTo(0.3, lastX + 50, people[i].y));\n                            lastX += 50;\n                        } else {\n                            lastX = x;\n                        }\n                    }\n\n                    this.countdown = this.wish.poseDuration;\n                    this.learning = true;\n                    break;\n                case States.WORSHIPING:\n                    // Not learning anymore\n                    this.poses && (this.poses.length = 0);\n                    var wish = this.wish;\n                    var people = this.people;\n                    var society = this.society;\n                    var praying = this.praying;\n                    var self = this;\n                    this.society.scheduleOnce(function () {\n                        var lostCount = 0;\n                        var array = [];\n                        people.forEach(function (person, index) {\n                            var behavior = person.getComponent('HumanBehavior');\n                            // Correct pose\n                            if (praying || detail === behavior.currentPose) {\n                                behavior.tribute = wish.tributePerP;\n                                behavior.currentState = States.WORSHIPING;\n                                array.push(person);\n                            }\n                            // Incorrect\n                            else {\n                                    if (Math.random() < society.lostCoef) {\n                                        var behavior = person.getComponent('HumanBehavior');\n                                        behavior.currentState = States.LOST;\n                                        lostCount++;\n                                    } else {\n                                        behavior.currentState = States.DEFAULT;\n                                        array.push(person);\n                                    }\n                                }\n                        });\n                        self.people = array;\n                        if (lostCount > 0) {\n                            society.lost(lostCount);\n                        }\n                    }, 0);\n                    this.wish = null;\n                    if (this.isLearning) {\n                        this.countdown = 4.5;\n                    } else {\n                        this.countdown = 2;\n                    }\n                    break;\n            }\n        }\n    },\n\n    punish: function punish() {\n        var people = this.people;\n        var society = this.society;\n        var self = this;\n        this.society.scheduleOnce(function () {\n            var lostCount = 0;\n            var array = [];\n            people.forEach(function (person, index) {\n                if (Math.random() < society.lostCoef) {\n                    lostCount++;\n                    var behavior = person.getComponent('HumanBehavior');\n                    behavior.currentState = States.LOST;\n                } else {\n                    array.push(person);\n                    person.getComponent('HumanBehavior').currentState = States.DEFAULT;\n                }\n            });\n            self.people = array;\n            if (lostCount > 0) {\n                society.lost(lostCount);\n            }\n            society.rejointDefault(self);\n        }, 0);\n        this.active = false;\n        this.state = States.DEFAULT;\n    },\n\n    update: function update(dt) {\n        var _this2 = this;\n\n        if (this.countdown > 0) {\n            this.countdown -= dt;\n        } else {\n            this.countdown = 0;\n            switch (this.state) {\n                case States.LEARNING:\n                    // Switch pose\n                    this.people.forEach(function (person) {\n                        var behavior = person.getComponent('HumanBehavior');\n                        if (!behavior.checked) {\n                            var prevPose = _this2.poses.indexOf(behavior.currentPose),\n                                poseId;\n                            do {\n                                poseId = Math.floor(Math.random() * _this2.poses.length);\n                            } while (poseId === prevPose && _this2.poses.length > 1);\n                            behavior.currentPose = _this2.poses[poseId];\n                        }\n                    });\n                    this.countdown = this.wish.poseDuration;\n                    break;\n                case States.PRAYING:\n                    var people = this.people;\n                    var society = this.society;\n                    var self = this;\n                    this.society.scheduleOnce(function () {\n                        var lostCount = 0;\n                        var array = [];\n                        people.forEach(function (person, index) {\n                            if (Math.random() < society.prayCoef) {\n                                lostCount++;\n                                var behavior = person.getComponent('HumanBehavior');\n                                behavior.currentState = States.LOST;\n                            } else {\n                                array.push(person);\n                                person.getComponent('HumanBehavior').currentState = States.DEFAULT;\n                            }\n                        });\n                        self.people = array;\n                        if (lostCount > 0) {\n                            society.lost(lostCount);\n                        }\n                        society.rejointDefault(self);\n                    }, 0);\n                    this.active = false;\n                    this.state = States.DEFAULT;\n                    break;\n                case States.WORSHIPING:\n                    var behaviors = [];\n                    this.people.forEach(function (person) {\n                        var behavior = person.getComponent('HumanBehavior');\n                        behaviors.push(behavior);\n                    });\n                    this.society.scheduleOnce(function () {\n                        for (var i = 0; i < behaviors.length; ++i) {\n                            behaviors[i].currentState = States.DEFAULT;\n                        }\n                    }, 0);\n                    this.state = States.DEFAULT;\n                    this.society.rejointDefault(this);\n                    break;\n            }\n        }\n    }\n});\n\nmodule.exports = Group;\n\ncc._RFpop();\n},{\"../../ykl/global\":\"global\"}],\"HumanBehavior\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, 'fd410vTg3VKQbu9IoKPzDA9', 'HumanBehavior');\n// ykl/HumanBehavior.js\n\nvar firstRight = false;\nvar firstWrong = false;\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        anim: {\n            'default': null,\n            type: cc.Animation\n        },\n\n        currentPose: {\n            visible: false,\n            'default': '',\n            displayName: '当前姿势',\n            notify: function notify() {\n                //if (CC_EDITOR) return;\n\n                // 播动画\n                this.anim.stop();\n                this.anim.play(this.currentPose);\n\n                // 做其他事情\n            }\n        },\n\n        currentWish: {\n            visible: false,\n            'default': '',\n            displayName: '当前愿望',\n            notify: function notify() {\n                //if (CC_EDITOR) return;\n\n                var name = WishType[this.currentWish.id];\n                this.wishIcon.getComponent(cc.Sprite).spriteFrame = this.sfWishIcons[this.currentWish.id];\n                this.wishIconAnim.stop();\n                this.wishIconAnim.play('show');\n                this.skillConfirm.enabled = false;\n            }\n        },\n\n        currentState: {\n            visible: false,\n            'default': window.States.DEFAULT,\n            notify: function notify(oldState) {\n                this._updateState(oldState);\n            }\n        },\n\n        wishIcon: {\n            'default': null,\n            type: cc.Node\n        },\n\n        wishIconAnim: {\n            'default': null,\n            type: cc.Animation\n        },\n\n        sfWishIcons: [cc.SpriteFrame],\n\n        pray: cc.Animation,\n\n        moveSpeed: 300,\n\n        idleMoveSpeed: 50,\n\n        idleChangeDirectionTimeRange: cc.v2(2, 4)\n    },\n\n    onLoad: function onLoad() {\n        this.checked = false;\n        this.canvas = cc.find('Canvas');\n        this.skillConfirm = this.wishIcon.getChildByName('skill_confirm').getComponent(cc.Sprite);\n\n        this._idleTime = this._idleChangeDirectionTime = 3;\n\n        this._updateState();\n    },\n\n    _updateState: function _updateState(oldState) {\n        var state = this.currentState;\n        if (oldState === window.States.PRAYING) {\n            this.pray.getComponent(cc.Sprite).enabled = false;\n        }\n\n        if (state === window.States.DEFAULT) {\n            this.hideWish();\n            this.anim.play('idle');\n            this.checked = false;\n        } else if (state === window.States.LEARNING) {\n            this.showWish();\n            this.wishIconAnim.stop();\n            this.skillConfirm.enabled = false;\n            this.wishIconAnim.play('show');\n\n            // if (oldState !== window.States.DOUBTING) {\n            // }\n            this.wishIcon.getComponent(cc.Button).interactable = true;\n        } else if (state === window.States.DOUBTING) {\n            if (firstWrong === false) {\n                firstWrong = true;\n                cc.find('Canvas/world/narrative').getComponent('Narrative').playLine(4);\n            }\n            // 头上显示问号\n            this.skillConfirm.enabled = true;\n            this.wishIconAnim.stop();\n            this.wishIconAnim.play('doubt');\n        } else if (state === window.States.CONFIRMING) {\n            this.hideWish();\n            // 头上有问号\n            // this.anim.play('confirming');\n        } else if (state === window.States.WORSHIPING) {\n                // 头上无问号，播放跪拜动画\n                this.hideWish();\n                var tribute = this.node.getChildByName('tribute');\n                var str = '+' + this.tribute;\n                tribute.active = true;\n                tribute.getComponent(cc.Label).string = str;\n                tribute.runAction(cc.sequence(cc.moveTo(1, 0, 120), cc.callFunc(function () {\n                    tribute.y = 80;\n                    tribute.active = false;\n                })).easing(cc.easeOut(2)));\n                // this.anim.play('p_act03');\n            } else if (state === window.States.LOST) {\n                    // 丢失或是死掉\n                    this.anim.play('die');\n                    this.checked = false;\n                    this.node.runAction(cc.sequence(cc.fadeOut(2.5), cc.callFunc(function () {\n                        this.node.removeFromParent();\n                    }, this)));\n                }\n    },\n\n    onChecked: function onChecked() {\n        var _this = this;\n\n        if (this.currentState !== window.States.LEARNING) {\n            return;\n        }\n        if (firstRight === false) {\n            (function () {\n                firstRight = true;\n                var nar = cc.find('Canvas/world/narrative').getComponent('Narrative');\n                _this.scheduleOnce(function () {\n                    nar.playLine(3);\n                }, 1);\n            })();\n        }\n        this.checked = true;\n        this.wishIcon.getComponent(cc.Button).interactable = false;\n        this.wishIconAnim.stop();\n        this.skillConfirm.enabled = true;\n        this.wishIconAnim.play('confirm');\n\n        this.canvas.emit('wish-clicked', this);\n    },\n\n    showWish: function showWish() {\n        this.wishIcon.stopAllActions();\n        this.wishIcon.active = true;\n        this.wishIcon.runAction(cc.moveTo(0.2, 0, 120));\n    },\n\n    hideWish: function hideWish() {\n        this.wishIcon.x = this.wishIcon.y = 0;\n        this.wishIcon.active = false;\n    },\n\n    update: function update(dt) {\n        if (this.currentState === window.States.DEFAULT) {\n            this.handleDefaultState(dt);\n        }\n    },\n\n    handleDefaultState: function handleDefaultState(dt) {\n        this._idleTime += dt;\n        if (this._idleTime > this._idleChangeDirectionTime) {\n            this._idleTime = 0;\n\n            var range = this.idleChangeDirectionTimeRange;\n            this._idleChangeDirectionTime = range.x + Math.random() * (range.y - range.x);\n\n            var direction = Math.floor(Math.random() * 2);\n            this.idleMoveSpeed *= direction === 0 ? -1 : 1;\n        }\n\n        var speed = this.idleMoveSpeed * dt;\n        var x = this.node.x + speed;\n        var width = this.canvas.width;\n\n        if (x <= 0 || x >= width) {\n            this.idleMoveSpeed *= -1;\n            x = this.node.x - speed;\n        }\n\n        if (this.idleMoveSpeed < 0 && this.anim.currentClip.name !== 'idle-left') {\n            this.anim.play('idle-left');\n        } else if (this.idleMoveSpeed > 0 && this.anim.currentClip.name !== 'idle') {\n            this.anim.play('idle');\n        }\n\n        this.node.x = x;\n    }\n});\n\ncc._RFpop();\n},{}],\"HumanManager\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '88808PpqTxP1LWq3PyX3Lux', 'HumanManager');\n// ykl/HumanManager.js\n\nvar HumanBehavior = require('HumanBehavior');\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {},\n\n    onLoad: function onLoad() {\n        // 已经被点击了的人类\n        this.checkedHumans = [];\n\n        var canvas = cc.find('Canvas');\n        canvas.on('wish-clicked', this.onHumanIconClicked, this);\n    },\n\n    'break': function _break() {\n        this.checkedHumans.forEach(function (item) {\n            (function (item) {\n                item.checked = false;\n                item.currentState = window.States.DOUBTING;\n\n                setTimeout(function () {\n                    item.currentState = window.States.LEARNING;\n                }, 500);\n            })(item);\n        });\n\n        this.checkedHumans = [];\n    },\n\n    update: function update(dt) {\n        this.updateHumanState();\n        this.updateHumanPosition(dt);\n    },\n\n    updateHumanState: function updateHumanState() {\n        var checkedHumans = this.checkedHumans;\n        for (var i = checkedHumans.length - 1; i >= 0; i--) {\n            var human = checkedHumans[i];\n\n            if (!human.checked) {\n                checkedHumans.splice(i, 1);\n            }\n        }\n    },\n\n    updateHumanPosition: function updateHumanPosition(dt) {\n        var checkedHumans = this.checkedHumans;\n        var length = checkedHumans.length;\n\n        if (length < 2) {\n            return;\n        }\n\n        var minDistance = 50;\n        var speed = checkedHumans[0].moveSpeed * dt;\n\n        for (var i = 0; i < length; i++) {\n            var first = checkedHumans[i];\n            var x = first.node.x;\n            var close = false;\n            var left = 0;\n            var right = 0;\n            var dif;\n\n            for (var j = 0; j < length; j++) {\n                var second = checkedHumans[j];\n                if (second === first) {\n                    continue;\n                }\n\n                dif = x - second.node.x;\n                if (Math.abs(dif) < minDistance) {\n                    close = true;\n                    break;\n                }\n\n                if (dif > 0) {\n                    left++;\n                } else {\n                    right++;\n                }\n            }\n\n            if (close) {\n                continue;\n            }\n\n            first.node.x += left > right ? -speed : speed;\n        }\n    },\n\n    addCheckedHuman: function addCheckedHuman(checkedHuman) {\n        var checkedHumans = this.checkedHumans;\n\n        if (checkedHumans.indexOf(checkedHuman) !== -1) {\n            return;\n        }\n\n        checkedHumans.push(checkedHuman);\n\n        if (checkedHumans.length > 1 && (checkedHuman.currentWish !== checkedHumans[0].currentWish || checkedHuman.currentPose !== checkedHumans[0].currentPose)) {\n            checkedHuman.checked = false;\n            this['break']();\n        }\n    },\n\n    onHumanIconClicked: function onHumanIconClicked(event) {\n        this.addCheckedHuman(event.detail);\n    }\n});\n\ncc._RFpop();\n},{\"HumanBehavior\":\"HumanBehavior\"}],\"LookAt\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '39182EXa1tHJpBfpeWWiLtq', 'LookAt');\n// scripts/utils/LookAt.js\n\ncc.Class({\n    'extends': cc.Component,\n    editor: {\n        executeInEditMode: true,\n        requireComponent: require('Camera')\n    },\n    properties: {\n        target: {\n            'default': null,\n            type: cc.Node,\n            tooltip: 'The target object to look at'\n        },\n        offset: {\n            'default': cc.Vec2.ZERO\n        },\n        speed: {\n            'default': 100,\n            tooltip: 'The max moving speed in world units per second'\n        }\n        //padding: {\n        //    default: 20,\n        //    tooltip: 'The distance in pixels between target object and the edge of screen'\n        //}\n    },\n\n    onLoad: function onLoad() {\n        this.camera = this.getComponent('Camera');\n    },\n\n    _getWorldPosition: function _getWorldPosition(node) {\n        var world = node.convertToWorldSpaceAR(cc.Vec2.ZERO);\n        var scene = cc.director.getRunningScene();\n        if (scene) {\n            return scene.convertToNodeSpaceAR(world);\n        } else {\n            return world;\n        }\n    },\n\n    _setWorldPosition: function _setWorldPosition(node, pos) {\n        var scene = cc.director.getRunningScene();\n        if (scene) {\n            pos = cc.v2(scene.convertToWorldSpaceAR(pos));\n        }\n        if (node.parent) {\n            node.position = node.parent.convertToNodeSpaceAR(pos);\n        } else {\n            node.position = pos;\n        }\n    },\n\n    lateUpdate: function lateUpdate(dt) {\n        if (!this.target) {\n            return;\n        }\n        if (!this.camera) {\n            return;\n        }\n\n        var src = this._getWorldPosition(this.node);\n        // get world position which not transformed by camera\n        var dest = this.target.convertToWorldSpaceAR(cc.Vec2.ZERO);\n        dest = this.camera.world.convertToNodeSpace(dest);\n        //\n        dest.addSelf(this.offset);\n\n        var delta = dest.sub(src);\n        var magSqr = delta.magSqr();\n        var maxDelta = this.speed * dt;\n\n        var pos;\n        if (magSqr <= maxDelta * maxDelta) {\n            pos = dest;\n        } else {\n            // tween\n            var dir = delta.divSelf(Math.sqrt(magSqr));\n            pos = src.addSelf(dir.mulSelf(maxDelta));\n        }\n\n        this._setWorldPosition(this.node, pos);\n    }\n});\n\ncc._RFpop();\n},{\"Camera\":\"Camera\"}],\"MainPanel\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '80017cfF89LOofh4s3wykhT', 'MainPanel');\n// scripts/ui/MainPanel.js\n\n\nvar Society = require('Society');\nvar AudioMng = require('AudioMng');\nvar Narrative = require('Narrative');\n\nvar MainPanel = cc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        society: {\n            'default': null,\n            type: Society\n        },\n        animCtrl: {\n            'default': null,\n            type: cc.Animation\n        },\n        eyesNode: {\n            'default': null,\n            type: cc.Node\n        },\n        startGameBtn: {\n            'default': null,\n            type: cc.Animation\n        },\n        battlePanelAnim: {\n            'default': null,\n            type: cc.Animation\n        },\n        narrative: Narrative\n    },\n\n    onLoad: function onLoad() {\n        this.hasMoveScene = false;\n        var scene = cc.director.getScene();\n        scene.y = -1450;\n        this.narrative.playLine(0);\n    },\n\n    hideMainPanelAnimEnd: function hideMainPanelAnimEnd() {\n        this.society.resume();\n        this.battlePanelAnim.play('showBattlePanel');\n    },\n\n    runMoveScene: function runMoveScene() {\n        var state = this.startGameBtn.getAnimationState('fadeInStartBtn');\n        state.wrapMode = cc.WrapMode.Reverse;\n        AudioMng.instance.playBGM();\n        this.society.narrative.playLine(1);\n        this.startGameBtn.play('fadeInStartBtn');\n        this.hasMoveScene = true;\n    },\n\n    update: function update(dt) {\n        if (this.hasMoveScene) {\n            var scene = cc.director.getScene();\n            if (scene.y >= 0) {\n                return;\n            }\n            scene.y += 300 * dt;\n            this.eyesNode.y -= 300 * dt;\n            if (scene.y > 0) {\n                scene.y = 0;\n                this.hasMoveScene = false;\n                this.animCtrl.play('hideMainPanel');\n            }\n        }\n    }\n\n});\n\ncc._RFpop();\n},{\"AudioMng\":\"AudioMng\",\"Narrative\":\"Narrative\",\"Society\":\"Society\"}],\"Narrative\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '0c78c7VGApJq6AlYoc9hlfy', 'Narrative');\n// scripts/ui/Narrative.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        label: cc.Label,\n        durationPerLine: 0,\n        textContents: {\n            'default': [],\n            type: 'String',\n            multiline: true\n        },\n        fadeDuration: 0\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {\n        this.currentTextId = 0;\n        this.node.opacity = 0;\n        // let idx = 0;\n        // this.schedule(function() {\n        //     this.playLine(idx);\n        //     idx++;\n        // }.bind(this), this.durationPerLine, 4, 0);\n    },\n\n    playLine: function playLine(idx) {\n        this.currentTextId = idx;\n        var actFadeOut = cc.fadeOut(this.fadeDuration);\n        var actFadeIn = cc.fadeIn(this.fadeDuration);\n        var callback = cc.callFunc(this.switchText, this);\n        var seq = cc.sequence(actFadeOut, callback, actFadeIn);\n        this.node.runAction(seq);\n        if (idx === 4 || idx === 3) {\n            this.scheduleOnce(function () {\n                this.hideLine();\n            }, 3);\n        }\n    },\n\n    hideLine: function hideLine() {\n        this.node.runAction(cc.fadeOut(2));\n    },\n\n    switchText: function switchText() {\n        this.label.string = this.textContents[this.currentTextId];\n    }\n\n});\n// called every frame, uncomment this function to activate update callback\n// update: function (dt) {\n\n// },\n\ncc._RFpop();\n},{}],\"PowerBar\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '63e23/x1P1DHajbaVkXJyIp', 'PowerBar');\n// scripts/ui/PowerBar.js\n\nvar PowerBar = cc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        content: {\n            'default': null,\n            type: cc.Label\n        }\n    },\n\n    onLoad: function onLoad() {\n        this.power = this.getComponent('cc.ProgressBar');\n        this.changePower = false;\n        this.newPowerValue = 0;\n        this.newPowerBarValue = 0;\n        this.addPower = 0;\n        this.curValue = this.power.progress * 100;\n        this.curProgressValue = 0;\n    },\n\n    updateValue: function updateValue(value, barValue, addorLower) {\n        this.changePower = true;\n        this.newPowerValue = value;\n        this.newPowerBarValue = barValue;\n        this.curProgressValue = parseFloat(this.power.progress.toFixed(2));\n        this.addPower = this.newPowerBarValue >= this.curProgressValue ? 1 : -1;\n    },\n\n    animaBar: function animaBar() {\n        if (this.changePower) {\n            this.curProgressValue = parseFloat(this.power.progress.toFixed(2));\n            if (this.curProgressValue !== this.newPowerBarValue) {\n                this.power.progress += 0.01 * this.addPower;\n            }\n            if (this.curValue !== this.newPowerValue) {\n                this.curValue += 1 * this.addPower;\n                this.content.string = this.curValue;\n            }\n            if (this.curProgressValue == this.newPowerBarValue && this.curValue === this.newPowerValue) {\n                this.changePower = false;\n            }\n        }\n    },\n\n    update: function update(dt) {\n        this.animaBar();\n    }\n});\n\ncc._RFpop();\n},{}],\"Resources\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '52a728YXuFIjIT4uiKYa6dO', 'Resources');\n// scripts/controllers/Resources.js\n\n\nvar BattlePanel = require('BattlePanel');\nvar GameOverPanel = require('GameOverPanel');\n\nvar Skills = {\n    0: \"雨|\" + 5,\n    1: \"火|\" + 10,\n    2: \"肉|\" + 15,\n    3: \"健康|\" + 20,\n    4: \"阳光|\" + 25,\n    5: \"谷物|\" + 30,\n    6: \"矿藏|\" + 35,\n    7: \"武器|\" + 40,\n    8: \"燃料|\" + 45,\n    9: \"绿色植物|\" + 50\n};\n\nvar INIT_POWER = 20;\nvar MIN_POWER = 0;\nvar MAX_POWER = 100;\n\nvar Resources = cc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        curPower: {\n            'default': 0,\n            type: cc.Integer,\n            visible: false\n        },\n\n        gameOver: {\n            'default': null,\n            type: GameOverPanel\n        }\n    },\n\n    statics: {\n        instance: null\n    },\n\n    onLoad: function onLoad() {\n        Resources.instance = this;\n    },\n\n    start: function start() {\n        this.curPower = 0;\n        this.addPower(INIT_POWER);\n    },\n\n    // 增加能量\n    addPower: function addPower(value) {\n        this.curPower += value;\n        this.curPower = this.curPower >= MAX_POWER ? MAX_POWER : this.curPower;\n        BattlePanel.instance.power.updateValue(this.curPower, this.curPower / Resources.MAX_POWER);\n    },\n\n    // 减能量\n    spendPower: function spendPower(value) {\n        this.curPower -= value;\n        this.curPower = this.curPower <= MIN_POWER ? MIN_POWER : this.curPower;\n        BattlePanel.instance.power.updateValue(this.curPower, this.curPower / Resources.MAX_POWER);\n\n        this.scheduleOnce(function () {\n            if (this.curPower < 10) {\n                this.gameOver.node.active = true;\n            }\n        }, 5);\n    }\n});\n\nResources.MIN_POWER = MIN_POWER;\nResources.MAX_POWER = MAX_POWER;\nResources.Skills = Skills;\n\ncc._RFpop();\n},{\"BattlePanel\":\"BattlePanel\",\"GameOverPanel\":\"GameOverPanel\"}],\"Rituals\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, 'ab5e3D8U49Blq3u+WTsfUi+', 'Rituals');\n// scripts/ui/Rituals.js\n\nvar Ritual = require('Ritual');\nvar FXSign = require('FXSign');\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        rituals: {\n            type: [cc.Node],\n            'default': []\n        },\n        sign: FXSign\n    },\n\n    activateRitual: function activateRitual(wish, pose) {\n        var ritual = this.rituals[wish];\n        var poseComp = ritual.getChildByName('pose').getComponent(cc.Sprite);\n        poseComp.spriteFrame = this.sign.sfSigns[pose];\n    },\n\n    close: function close() {\n        this.node.active = false;\n    }\n});\n\ncc._RFpop();\n},{\"FXSign\":\"FXSign\",\"Ritual\":\"Ritual\"}],\"Ritual\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '81663uJAYFCO5ALYANOjbKq', 'Ritual');\n// scripts/ui/Ritual.js\n\ncc.Class({\n    \"extends\": cc.Component,\n\n    properties: {\n        pose: cc.Sprite\n    }\n});\n\ncc._RFpop();\n},{}],\"SkillMng\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, 'ea87fcJKItLaqsfUPzHz3Xx', 'SkillMng');\n// scripts/controllers/SkillMng.js\n\ncc.Class({\n    \"extends\": cc.Component,\n\n    properties: {\n        // foo: {\n        //    default: null,\n        //    url: cc.Texture2D,  // optional, default is typeof default\n        //    serializable: true, // optional, default is true\n        //    visible: true,      // optional, default is true\n        //    displayName: 'Foo', // optional\n        //    readonly: false,    // optional, default is false\n        // },\n        // ...\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {}\n\n});\n// called every frame, uncomment this function to activate update callback\n// update: function (dt) {\n\n// },\n\ncc._RFpop();\n},{}],\"Skill\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, 'b874brCF5xOxoY39iXDY0fK', 'Skill');\n// scripts/ui/Skill.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        label: cc.Label,\n        sprite: cc.Sprite,\n        sfIcons: [cc.SpriteFrame],\n        skillID: {\n            'default': 0,\n            type: cc.Integer,\n            visible: false\n        },\n        cost: {\n            'default': 0,\n            type: cc.Integer,\n            visible: false\n        },\n        button: cc.Button,\n        cooldown: 0\n    },\n\n    userSkill: function userSkill() {\n        if (this.callback) {\n            this.callback.call(this.target, this.skillID, this.cost);\n            this.button.interactable = false;\n            this.scheduleOnce(this.onButtonCooldown.bind(this), this.cooldown);\n        }\n    },\n\n    onButtonCooldown: function onButtonCooldown() {\n        var Resources = require('Resources');\n        if (this.cost > Resources.instance.curPower) {\n            return;\n        }\n        this.button.interactable = true;\n    },\n\n    updateSkill: function updateSkill(skillInfo, callback, target) {\n        this.skillID = skillInfo.id;\n        this.cost = skillInfo.cost;\n        this.label.string = this.cost;\n        this.sprite.spriteFrame = this.sfIcons[this.skillID];\n        this.callback = callback;\n        this.target = target;\n    }\n});\n\ncc._RFpop();\n},{\"Resources\":\"Resources\"}],\"Society\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '07354aU81JPS5ESw2HLIjGo', 'Society');\n// scripts/controllers/Society.js\n\nrequire('../../ykl/global');\nvar Group = require('Group');\nvar Wish = require('../Wish');\nvar BattlePanel = require('BattlePanel');\nvar FXRitual = require('FXRitual');\nvar GameOverPanel = require('GameOverPanel');\nvar AssetMng = require('AssetMng');\nvar AudioMng = require('AudioMng');\nvar Narrative = require('Narrative');\n\nvar wishTypeList = cc.Enum.getList(WishType);\nvar Wishes = {};\nvar PopulationLevel = [3, 8, 20, 35, 50];\nvar Levels = {};\nfor (var i = 0; i < wishTypeList.length; ++i) {\n    var id = wishTypeList[i].value;\n    Wishes[id] = new Wish();\n    Wishes[id].id = id;\n    Levels[PopulationLevel[i]] = id;\n}\n\nfunction createRitual(pose, id) {\n    return {\n        id: id,\n        pose: pose,\n        count: 0,\n        level: 0\n    };\n}\n\nvar Society = cc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        // Unlearnt Wishes\n        wishes: {\n            'default': [],\n            type: [Wish]\n        },\n\n        // Root node to host all people\n        host: {\n            'default': null,\n            type: cc.Node\n        },\n\n        battlePanel: {\n            'default': null,\n            type: BattlePanel\n        },\n\n        fxRitual: {\n            'default': null,\n            type: FXRitual\n        },\n\n        gameOver: {\n            'default': null,\n            type: GameOverPanel\n        },\n\n        assetMng: {\n            'default': null,\n            type: AssetMng\n        },\n\n        narrative: Narrative,\n\n        // Decide when to ask\n        prayDelay: 20,\n\n        // Decide the possibility to lost people\n        lostCoef: 1,\n\n        prayCoef: 0.3,\n\n        rollWishCoef: 1.3,\n\n        // Decide when to learn, +- 1 floating\n        learnDelay: 10,\n\n        // Population\n        population: 0\n    },\n\n    pause: function pause() {\n        this._pause = true;\n        this.node.emit('pause');\n    },\n\n    resume: function resume() {\n        this._pause = false;\n        this.node.emit('resume');\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {\n        this.rituals = {};\n        this.ritualCount = 0;\n        this.lastRitualID = 0;\n\n        this.firstWishPop = false;\n\n        this._pause = true;\n\n        this._nextWish = null;\n\n        this.god = this.getComponent('God');\n\n        // People who do nothing\n        this.defaultGroup = new Group(this);\n        // People who is learning the learningSkill\n        this.learningGroup = new Group(this);\n        // All running groups which is not in default state\n        this.runningGroups = [];\n\n        this.prayTimeout = this.prayDelay;\n        this.learnTimeout = this.learnDelay;\n\n        // AudioMng.instance.playBGM();\n\n        this.assetMng.init((function () {\n            for (var i = 0; i < wishTypeList.length; ++i) {\n                var id = wishTypeList[i].value;\n                var wishInfo = this.assetMng.wishesDB[id];\n                Wishes[id].poseCount = parseInt(wishInfo.poseCount);\n                Wishes[id].poseDuration = parseInt(wishInfo.poseDuration);\n                Wishes[id].moveSpeed = parseInt(wishInfo.moveSpeed);\n                Wishes[id].ritualNeed = parseInt(wishInfo.ritualNeed);\n                Wishes[id].tributePerP = parseInt(wishInfo.tributePerP);\n                Wishes[id].divineConsume = parseInt(wishInfo.divineConsume);\n                Wishes[id].wishConsume = parseInt(wishInfo.wishConsume);\n                Wishes[id].levelBonus = parseInt(wishInfo.levelBonus);\n                Wishes[id].attraction = parseInt(wishInfo.attraction);\n            }\n        }).bind(this));\n    },\n\n    wishCheck: function wishCheck(group, wishID) {\n        if (group.isLearning() && group.wish && group.wish.id === wishID) {\n            var i,\n                people = group.people,\n                poses = {},\n                behavior,\n                pose,\n                max = 1,\n                pickedPose;\n            for (i = 0; i < people.length; ++i) {\n                behavior = people[i].getComponent('HumanBehavior');\n                if (!behavior.checked) {\n                    continue;\n                }\n                pose = behavior.currentPose;\n                if (poses[pose]) {\n                    poses[pose]++;\n                    if (poses[pose] > max) {\n                        max = poses[pose];\n                        pickedPose = pose;\n                    }\n                } else {\n                    poses[pose] = 1;\n                }\n            }\n            // Ritual need satisfied\n            var wish = group.wish;\n            if (pickedPose && max >= wish.ritualNeed) {\n                this.scheduleOnce(function () {\n                    var poseID = Poses.indexOf(pickedPose);\n                    this.fxRitual.playAnim(poseID);\n                    // this.god.showWonder();\n                }, 2.5);\n                AudioMng.instance.playRitual();\n                this.ritualLearnt(wish, pickedPose);\n                this.tribute(max * wish.wishConsume, wish);\n                group.toState(States.WORSHIPING, pickedPose);\n            }\n        } else if (group.isPraying() && group.prayRitual === this.rituals[wishID].pose) {\n            this.tribute(group.people.length * Wishes[wishID].wishConsume, Wishes[wishID]);\n            group.toState(States.WORSHIPING);\n        } else if (group.wish) {\n            // Force update pose\n            group.punish();\n        }\n    },\n\n    skillFired: function skillFired(wishID) {\n        this.wishCheck(this.learningGroup, wishID);\n\n        for (var i = 0; i < this.runningGroups.length; ++i) {\n            var group = this.runningGroups[i];\n            this.wishCheck(group, wishID);\n        }\n    },\n\n    tribute: function tribute(resources, wish) {\n        this.god.tribute(resources);\n        var newbies = Math.round(wish.attraction + Math.random() * 2 - 1);\n        this.getComponent('generator').generate(newbies);\n        AudioMng.instance.playBaby();\n\n        // Upgrade rituals\n        var ritual = this.rituals[wish.id];\n        ritual.count++;\n        var lastLevel = ritual.level;\n        ritual.level = Math.floor(ritual.count / 3);\n        if (ritual.level > lastLevel) {\n            this.god.showWonder(ritual.id);\n        }\n    },\n\n    updatePopulation: function updatePopulation() {\n        this.battlePanel.people.string = this.population;\n        var max, count;\n        for (var i = 0; i < PopulationLevel.length; ++i) {\n            count = PopulationLevel[i];\n            if (this.population >= count && Levels[count]) {\n                max = count;\n                id = Levels[count];\n            } else if (this.population < count) {\n                break;\n            }\n        }\n        if (max) {\n            var unlocked = this.battlePanel.unlockBtn(Levels[max]);\n            unlocked && this.newSkillsAvailable(unlocked);\n        }\n    },\n\n    newSkillsAvailable: function newSkillsAvailable(skills) {\n        for (var i = 0; i < skills.length; ++i) {\n            var id = skills[i];\n            if (Wishes[id]) {\n                this.wishes.push(Wishes[id]);\n            }\n        }\n    },\n\n    startLearning: function startLearning() {\n        if (this.learningGroup.isLearning()) {\n            this.learningGroup.toState(States.LEARNING);\n        }\n    },\n\n    learn: function learn() {\n        if (this.firstWishPop === false) {\n            this.firstWishPop = true;\n            this.scheduleOnce(function () {\n                this.narrative.playLine(2);\n            }, 1);\n        }\n        for (var i = 0; i < this.wishes.length; ++i) {\n            var wish = this.wishes[i];\n            this.learningGroup.reuse(this);\n            var delay = 2 + Math.random() * 2;\n            var succeed = this.defaultGroup.split(wish, this.learningGroup);\n            if (succeed) {\n                this.learningGroup.wish = wish;\n                this.learningGroup.learning = true;\n                this.scheduleOnce(this.startLearning, delay);\n                break;\n            }\n        }\n    },\n\n    ritualLearnt: function ritualLearnt(wish, pose) {\n        this.rituals[wish.id] = createRitual(pose, this.lastRitualID);\n        this.lastRitualID++;\n        this.ritualCount = Object.keys(this.rituals).length;\n        this.prayTimeout = this.prayDelay;\n        var index = this.wishes.indexOf(wish);\n        if (index !== -1) {\n            this.wishes.splice(index, 1);\n        }\n        index = UnusedPoses.indexOf(pose);\n        if (index > -1) {\n            UnusedPoses.splice(index, 1);\n        }\n        var btnRituals = this.battlePanel.btnRituals;\n        if (!btnRituals.active) {\n            btnRituals.active = true;\n            btnRituals.runAction(cc.fadeIn(1));\n        }\n        this.battlePanel.rituals.activateRitual(wish.id, Poses.indexOf(pose));\n    },\n\n    rejointDefault: function rejointDefault(group) {\n        var defaultGroup = this.defaultGroup;\n        group.people.forEach(function (person) {\n            defaultGroup.addMember(person);\n        });\n        if (group === this.learningGroup) {\n            group.unuse();\n        } else {\n            var index = this.runningGroups.indexOf(group);\n            if (index >= 0) {\n                this.runningGroups.splice(index, 1);\n            }\n            cc.pool.putInPool(group);\n        }\n    },\n\n    lost: function lost(count) {\n        this.population -= count;\n        this.updatePopulation();\n        if (this.population < 3) {\n            this.gameOver.node.active = true;\n        }\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    update: function update(dt) {\n        if (this._pause) {\n            return;\n        }\n\n        // Learn new skill if possible\n        if (this.wishes.length > 0 && !this.learningGroup.learning) {\n            if (this.learnTimeout <= 0 || this.ritualCount === 0) {\n                this.learnTimeout = this.learnDelay;\n                this.learn();\n            }\n            this.learnTimeout -= dt;\n        }\n        if (this.learningGroup.active) {\n            this.learningGroup.update(dt);\n        }\n        // Pray with ritual\n        var group;\n        if (this.ritualCount > 0) {\n            // Ready for praying\n            if (this.prayTimeout <= 0) {\n                this.prayTimeout = this.prayDelay;\n                if (this._nextWish === null) {\n                    var knownWishes = Object.keys(this.rituals);\n                    var count = knownWishes.length;\n                    var rand = Math.random() * this.rollWishCoef;\n                    var unit = rand / count;\n                    var bouns = (this.rollWishCoef - 1) / (count * (count - 1) / 2);\n                    var range = 0;\n                    var rolled = 0;\n                    for (var _i = 0; _i < knownWishes.length; ++_i) {\n                        range += unit + bouns * _i;\n                        if (rand < range) {\n                            rolled = _i;\n                            break;\n                        }\n                    }\n                    var wishID = knownWishes[rolled];\n                    this._nextWish = Wishes[wishID];\n                }\n                group = cc.pool.hasObject(Group) ? cc.pool.getFromPool(Group) : new Group(this);\n                var succeed = this.defaultGroup.split(this._nextWish, group);\n                if (succeed) {\n                    group.wish = this._nextWish;\n                    group.praying = true;\n                    this.runningGroups.push(group);\n                    group.toState(States.PRAYING);\n                    this._nextWish = null;\n                }\n            }\n            this.prayTimeout -= dt;\n        }\n\n        for (var _i2 = 0; _i2 < this.runningGroups.length; ++_i2) {\n            group = this.runningGroups[_i2];\n            if (group.active) {\n                group.update(dt);\n            }\n        }\n    }\n});\n\nSociety.Wishes = Wishes;\n\ncc._RFpop();\n},{\"../../ykl/global\":\"global\",\"../Wish\":\"Wish\",\"AssetMng\":\"AssetMng\",\"AudioMng\":\"AudioMng\",\"BattlePanel\":\"BattlePanel\",\"FXRitual\":\"FXRitual\",\"GameOverPanel\":\"GameOverPanel\",\"Group\":\"Group\",\"Narrative\":\"Narrative\"}],\"TouchStart\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '6dc38qFSeRN4ZJQf+mnMO8Q', 'TouchStart');\n// scripts/ui/TouchStart.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        mask: cc.Node\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {\n        this.node.runAction(cc.repeatForever(cc.sequence(cc.fadeOut(1), cc.fadeIn(1))));\n        cc.eventManager.addListener({\n            event: cc.EventListener.TOUCH_ONE_BY_ONE,\n            onTouchBegan: function onTouchBegan(touch, event) {\n                // don't capture the event\n                return true;\n            },\n            onTouchEnded: (function (touch, event) {\n                this.mask.runAction(cc.fadeIn(1));\n                cc.director.loadScene('game');\n            }).bind(this)\n        }, this);\n    }\n\n});\n// called every frame, uncomment this function to activate update callback\n// update: function (dt) {\n\n// },\n\ncc._RFpop();\n},{}],\"TriggerAnimEvent\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, 'd6b5bKEME1LdZrQDXO704qZ', 'TriggerAnimEvent');\n// scripts/utils/TriggerAnimEvent.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        startBtnAnim: {\n            'default': null,\n            type: cc.Animation\n        },\n        startBtn: cc.Node\n    },\n\n    eyesAnimEnd: function eyesAnimEnd() {\n        this.startBtn.active = true;\n        this.startBtnAnim.play('fadeInStartBtn');\n    }\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n\ncc._RFpop();\n},{}],\"Wish\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, 'cd80bMwggpJGrAca2Y6vLoB', 'Wish');\n// scripts/Wish.js\n\nvar Wish = cc.Class({\n    name: 'Wish',\n    properties: {\n        id: 0,\n        poseCount: 2,\n        poseDuration: 3,\n        moveSpeed: 50,\n        ritualNeed: 3,\n        tributePerP: 2,\n        divineConsume: 1,\n        wishConsume: 3,\n        levelBonus: 0.1,\n        attraction: 1\n    }\n});\n\nmodule.exports = Wish;\n\ncc._RFpop();\n},{}],\"generator\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '7d32f/FDHZEMY1WZNTt3Lps', 'generator');\n// scripts/levels/generator.js\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        population: 3,\n\n        y: {\n            type: [cc.Integer],\n            'default': []\n        },\n\n        // Person prefab for generating people\n        person: {\n            'default': null,\n            type: cc.Prefab\n        }\n    },\n\n    // use this for initialization\n    start: function start() {\n        this.society = this.getComponent('Society');\n\n        if (!this.society._pause) {\n            this.generate(this.population);\n        } else {\n            this.society.node.on('resume', function () {\n                this.generate(this.population);\n            }, this);\n        }\n    },\n\n    generate: function generate(count) {\n        var society = this.society;\n        if (!society.host) {\n            return;\n        }\n        for (var i = 0; i < count; ++i) {\n            var newbie = cc.instantiate(this.person);\n            // Random between [50, width-100)\n            var w = cc.winSize.width;\n            newbie.x = w * 0.2 + Math.floor(Math.random() * w * 0.6) - 96;\n            newbie.y = this.y.length > 0 ? this.y[i % this.y.length] : 100;\n\n            if (this.y.length > 0) {\n                newbie.scale = 1.1 - i % this.y.length / this.y.length * 0.25;\n            }\n            newbie.scale += (Math.random() - 0.5) * 0.05;\n\n            var zIndex = cc.winSize.height - newbie.y;\n            newbie.opacity = 0;\n            newbie.runAction(cc.fadeIn(1));\n            society.host.addChild(newbie, zIndex);\n            society.defaultGroup.addMember(newbie);\n        }\n        society.population += count;\n        society.updatePopulation();\n    }\n});\n\ncc._RFpop();\n},{}],\"global\":[function(require,module,exports){\n\"use strict\";\ncc._RFpush(module, '796dclFGDdGeoH9i6fiyI+J', 'global');\n// ykl/global.js\n\n\nvar States = cc.Enum({\n    DEFAULT: 0,\n    LEARNING: 1,\n    DOUBTING: 2,\n    CONFIRMING: 3,\n    WORSHIPING: 4,\n    PRAYING: 5,\n    LOST: 6\n});\n\nvar WishType = cc.Enum({\n    Rain: -1,\n    Fire: -1,\n    Meat: -1,\n    Sun: -1,\n    Wheet: -1\n});\n\nvar Poses = ['p_act01', 'p_act02', 'p_act03', 'p_act04', 'p_act05', 'p_act06', 'p_act07', 'p_act08'];\n\nvar UnusedPoses = ['p_act01', 'p_act02', 'p_act03', 'p_act04', 'p_act05', 'p_act06', 'p_act07', 'p_act08'];\n\nwindow.States = States;\nwindow.Poses = Poses;\nwindow.UnusedPoses = UnusedPoses;\nwindow.WishType = WishType;\n\ncc._RFpop();\n},{}]},{},[\"Society\",\"FXRitual\",\"Narrative\",\"ButtonScaler\",\"FXSign\",\"Group\",\"Camera\",\"LookAt\",\"EffectMng\",\"Resources\",\"GameOverPanel\",\"PowerBar\",\"FXWonder\",\"TouchStart\",\"global\",\"generator\",\"MainPanel\",\"Ritual\",\"HumanManager\",\"God\",\"BattlePanel\",\"Rituals\",\"AssetMng\",\"Skill\",\"Wish\",\"TriggerAnimEvent\",\"AudioMng\",\"SkillMng\",\"HumanBehavior\",\"Credits\"]);\n"],"sourceRoot":"/source/"}