require=function t(e,i,s){function n(o,l){if(!i[o]){if(!e[o]){var a="function"==typeof require&&require;if(!l&&a)return a(o,!0);if(c)return c(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var r=i[o]={exports:{}};e[o][0].call(r.exports,function(t){var i=e[o][1][t];return n(i?i:t)},r,r.exports,t,e,i,s)}return i[o].exports}for(var c="function"==typeof require&&require,o=0;o<s.length;o++)n(s[o]);return n}({AssetMng:[function(t,e,i){cc._RFpush(e,"0c603JjbaVKjaNf1tpsYduy","AssetMng"),cc.Class({"extends":cc.Component,properties:{ballImages:{"default":[],type:[cc.SpriteFrame],visible:!0}},onLoad:function(){},update:function(t){}}),cc._RFpop()},{}],Ball:[function(t,e,i){cc._RFpush(e,"8615fOmcHVCPJQ3Sh5zGWBQ","Ball");var s=t("./GlobalSettings"),n=t("./physics");BallType=cc.Enum({CUE:0,NORMAL:1}),cc.Class({"extends":cc.Component,properties:{phyObj:{"default":null,visible:!1},type:{type:BallType,"default":BallType.NORMAL}},onLoad:function(){this.weight=this.type===BallType.CUE?s.instance.CUE_BALL_WEIGHT:s.instance.BALL_WEIGHT,this.maxSpeed=s.instance.MAX_SPEED,this.r=s.instance.BALL_R,this.friction=s.instance.FRICTION,this.elasticity=s.instance.ELASTICITY},initPhysics:function(){var t=this.node._sgNode.getPosition(),e=this.getComponent(cc.SpriteRenderer);this.phyObj=new n.CircleObject(this.weight,this.r,this.maxSpeed,e,t),this.phyObj.setFriction(this.friction),this.phyObj.setElasticity(this.elasticity)},start:function(){this.initPhysics();var t=this;t.type===BallType.CUE&&cc.eventManager.addListener({event:cc.EventListener.TOUCH_ALL_AT_ONCE,onTouchesEnded:function(e,i){t.fire(),s.instance.hideInstruction(),i.stopPropagation()}},this)},fire:function(){var t=cp.v(-s.instance.IMPULSE,0);this.phyObj.body.applyImpulse(t,cp.v(0,0))},update:function(t){var e=this.phyObj.getPosition();this.node.x=e.x,this.node.y=e.y}}),cc._RFpop()},{"./GlobalSettings":"GlobalSettings","./physics":"physics"}],GlobalSettings:[function(t,e,i){cc._RFpush(e,"6db33nAO2xER6r5mtCHKbXR","GlobalSettings");var s=t("./physics"),n=cc.Class({"extends":cc.Component,properties:{debugDisplay:!0,instruction:{"default":null,type:cc.ENode},ballGroups:{"default":[],type:[cc.ENode]},ballNumberLevel:1,CUE_BALL_WEIGHT:2,BALL_WEIGHT:1,BALL_R:15,MAX_SPEED:200,FRICTION:.25,ELASTICITY:.3,IMPULSE:200,WALL_WIDTH:32,WALL_FRICTION:1,WALL_ELASTICITY:2},onLoad:function(){n.instance=this,this.startInstructionBlink();for(var t=0;t<this.ballGroups.length;++t)this.ballNumberLevel<t&&(this.ballGroups[t].active=!1);cc.director.setDisplayStats(!0)},startInstructionBlink:function(){var t=cc.fadeTo(.5,0),e=cc.fadeTo(.5,255),i=cc.repeatForever(cc.sequence(t,e));this.instruction._sgNode.runAction(i)},hideInstruction:function(){this.instruction._sgNode.stopAllActions(),this.instruction.active=!1},restart:function(){s.clear(),cc.director.loadScene("table")}});cc._RFpop()},{"./physics":"physics"}],PhysicTable:[function(t,e,i){cc._RFpush(e,"0ccb0Zik3NAA5WJ2AKPmctJ","PhysicTable");var s=t("./physics"),n=t("./GlobalSettings");cc.Class({"extends":cc.Component,properties:{space:{"default":null,visible:!1},debugNode:{"default":null,visible:!1},leftWall:{"default":null,visible:!1},rightWall:{"default":null,visible:!1},topWall:{"default":null,visible:!1},bottomWall:{"default":null,visible:!1}},createPhysicsWorld:function(){s.init(cc.director.getRunningScene()),this.space=s.world,this.space.gravity=cp.v(0,0);var t=n.instance.WALL_WIDTH,e=n.instance.WALL_ELASTICITY,i=n.instance.WALL_FRICTION,c=cc.winSize.width,o=cc.winSize.height;this.leftWall=new s.StaticObject(0,0,t,o,null),this.topWall=new s.StaticObject(0,o-t,c,t,null),this.rightWall=new s.StaticObject(c-t,0,t,o,null),this.bottomWall=new s.StaticObject(0,0,c,t,null),this.leftWall.setElasticity(e),this.leftWall.setFriction(i),this.topWall.setElasticity(e),this.topWall.setFriction(i),this.rightWall.setElasticity(e),this.rightWall.setFriction(i),this.bottomWall.setElasticity(e),this.bottomWall.setFriction(i)},onLoad:function(){this.createPhysicsWorld(),n.instance.debugDisplay&&this.setupDebugNode()},setupDebugNode:function(){this.debugNode=cc.PhysicsDebugNode.create(this.space),this.debugNode.visible=!0;var t=this.node._sgNode;this.debugNode.setPosition(-t.x,-t.y),t.addChild(this.debugNode,100)},update:function(t){s.update(t)}}),cc._RFpop()},{"./GlobalSettings":"GlobalSettings","./physics":"physics"}],physics:[function(t,e,i){cc._RFpush(e,"84454wOejlF9IFadHUVtTNz","physics");var s={world:null,scene:null,inited:null,handlers:[],shapes:[],bodies:[],calculVector:function(t){var e=t.getNormal(0),i=cc.p(e.x,-e.y);return i},calculAngle:function(t){return cc.pToAngle(this.calculVector(t))},init:function(t){if(this.scene=t,!this.inited){this.world=null;var e=this.world=new cp.Space;e.iterations=60;this.inited=!0}},update:function(t){this.inited&&this.world.step(t)},addCollisionHandler:function(t,e,i,s,n,c){this.inited&&(this.world.addCollisionHandler(t,e,i,s,n,c),this.handlers.push([t,e]))},registerShape:function(t){s.shapes.push(t)},registerBody:function(t){s.bodies.push(t)},_realClear:function(){if(this.inited){for(var t,e,i,s=this.world,n=this.handlers.length-1;n>=0;--n)t=this.handlers[n],s.removeCollisionHandler(t[0],t[1]);this.handlers=[];for(var n=this.shapes.length-1;n>=0;--n)e=this.shapes[n],s.containsShape(e)&&(e.body.isStatic()?s.removeStaticShape(e):s.removeShape(e));this.shapes=[];for(var n=this.bodies.length-1;n>=0;--n)i=this.bodies[n],s.containsBody(i)&&s.removeBody(i);this.bodies=[]}},clear:function(){var t=this.world;t&&(t.eachShape(this.registerShape),t.eachBody(this.registerBody),t.isLocked()?t.addPostStepCallback(this._realClear.bind(this)):this._realClear())},StaticObject:null,StaticPolyObject:null,StaticSensor:null,DynamicSensor:null,PhysicsObject:null,CircleObject:null};s.StaticObject=cc._Class.extend({view:null,shape:null,ctor:function(t,e,i,n,c){var o={};o.l=t,o.r=t+i,o.t=e+n,o.b=e,this.shape=new cp.BoxShape2(s.world.staticBody,o),s.world.addShape(this.shape),this.shape.obj=this,this.view=c},setFriction:function(t){this.shape.setFriction(t)},setElasticity:function(t){this.shape.setElasticity(t)},removeSelf:function(){s.world.removeStaticShape(this.shape)}}),s.StaticPolyObject=cc._Class.extend({view:null,shape:null,ctor:function(t,e,i){this.shape=new cp.PolyShape(s.world.staticBody,e,i||cp.v(0,0)),s.world.addShape(this.shape),this.shape.obj=this,this.view=t},setFriction:function(t){this.shape.setFriction(t)},setElasticity:function(t){this.shape.setElasticity(t)},removeSelf:function(){s.world.removeStaticShape(this.shape)}}),s.StaticSensor=cc._Class.extend({view:null,shape:null,ctor:function(t,e,i,n,c){this.shape=new cp.SegmentShape(s.world.staticBody,cp.v(t,e+n),cp.v(t+i,e+n),5),this.shape.setSensor(!0),s.world.addShape(this.shape),this.shape.obj=this,this.view=c},removeSelf:function(){s.world.removeStaticShape(this.shape)}}),s.DynamicSensor=cc._Class.extend({body:null,shape:null,view:null,ctor:function(t,e,i,n,c){this.body=new cp.Body(1,cp.momentForBox(1,i,n)),this.body.setPos(cp.v(t,e)),this.shape=new cp.BoxShape(this.body,i,n),this.shape.setSensor(!0),s.world.addShape(this.shape),this.shape.obj=this,this.view=c},removeSelf:function(){s.world.removeShape(this.shape),s.world.removeBody(this.body)}}),s.PhysicsObject=cc._Class.extend({body:null,shape:null,type:null,view:null,ctor:function(t,e,i,n,c){this.body=new cp.Body(t,cp.momentForBox(t,e.width,e.height)),this.shape=new cp.BoxShape(this.body,e.width,e.height),s.world.addShape(this.shape),s.world.addBody(this.body),this.setMaxSpeed(i),this.setView(n),c&&this.setPosition(c),this.shape.obj=this},setPosition:function(t){this.body.setPos(t)},move:function(t,e){var i=cc.p(e,0),s=cc.pRotateByAngle(i,cc.p(0,0),cc.degreesToRadians(t));this.body.applyImpulse(s,cp.v(0,0))},targetMove:function(t,e){var i=cc.p(e,0),s=cc.pToAngle(cc.pSub(t,this.body.p)),n=cc.pRotateByAngle(i,cc.p(0,0),s);this.body.applyImpulse(n,cp.v(0,0))},setMaxSpeed:function(t){this.body.v_limit=t},getPosition:function(){return this.body.p},setView:function(t){this.view=t},setFriction:function(t){this.shape.setFriction(t)},setElasticity:function(t){this.shape.setElasticity(t)},removeSelf:function(){s.world.removeShape(this.shape),s.world.removeBody(this.body)}}),s.CircleObject=s.PhysicsObject.extend({ctor:function(t,e,i,n,c){this.body=new cp.Body(t,cp.momentForCircle(t,0,e,cp.v(0,0))),this.shape=new cp.CircleShape(this.body,e,cp.v(0,0)),s.world.addShape(this.shape),s.world.addBody(this.body),this.setMaxSpeed(i),this.setView(n),c&&this.setPosition(c),this.shape.obj=this}}),e.exports=s,cc._RFpop()},{}]},{},["AssetMng","PhysicTable","GlobalSettings","physics","Ball"]);
//# sourceMappingURL=project.js.map