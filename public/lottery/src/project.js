require=function t(i,e,n){function s(a,o){if(!e[a]){if(!i[a]){var u="function"==typeof require&&require;if(!o&&u)return u(a,!0);if(r)return r(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var c=e[a]={exports:{}};i[a][0].call(c.exports,function(t){var e=i[a][1][t];return s(e?e:t)},c,c.exports,t,i,e,n)}return e[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)s(n[a]);return s}({Game:[function(t,i,e){"use strict";function n(t,i){return t=Math.ceil(t),i=Math.floor(i),Math.floor(Math.random()*(i-t))+t}cc._RFpush(i,"99a21/QP1lPe7/XszA26w5W","Game");var s=t("NumberManager"),r=cc.Enum({Setup:-1,ReadyToRoll:-1,Rolling:-1});cc.Class({"extends":cc.Component,properties:{numberMng:s,btnStart:cc.Button,sizeInput:cc.EditBox,startInput:cc.EditBox,winnerLayout:cc.Layout,winnerPrefab:cc.Prefab,instruction:cc.RichText,state:{get:function(){return this._state},set:function(t){this._state!==t&&(this._state=t,this.updateState(t))},visible:!1}},onLoad:function(){this.size=null,this.startIdx=null,this.pool=[],this.winner=-1,this.state=r.Setup,this.numberMng.init(this)},btnStartClick:function(){this.state===r.ReadyToRoll&&(this.state=r.Rolling,this.numberMng.startRolling(),this.scheduleOnce(this.showResult,this.numberMng.digits*this.numberMng.delayPerDigits+2,this))},showResult:function(){var t=n(0,this.pool.length);this.winner=this.pool[t],this.numberMng.showResult(this.winner),this.pool.splice(t,1)},finishResult:function(){var t=cc.instantiate(this.winnerPrefab);t.getComponent("WinnerLabel").init(this.winner),this.winnerLayout.node.addChild(t),this.state=r.ReadyToRoll},updateSize:function(t){var i=0;try{i=parseInt(t.string)}catch(e){return void(t.string="invalid")}this.size=i,"number"!=typeof this.startIdx||Number.isNaN(this.startIdx)||(this.state=r.ReadyToRoll),this.startInput.setFocus()},generatePool:function(){this.pool=[];for(var t=0;t<this.size;++t)this.pool.push(this.startIdx+t)},updateStartIdx:function(t){var i=0;try{i=parseInt(t.string)}catch(e){return void(t.string="invalid")}this.startIdx=i,"number"!=typeof this.size||Number.isNaN(this.size)||(this.state=r.ReadyToRoll)},updateState:function(t){switch(t){case r.Setup:this.sizeInput.maxLength=8,this.sizeInput.string="",this.btnStart.interactable=!1,this.instruction.string="请输入参与抽奖人数和开始序号，如需重新输入请按复位按钮";break;case r.ReadyToRoll:this.sizeInput.maxLength=0,this.btnStart.interactable=!0,this.instruction.string="本次抽奖参与者共 <color=green>"+this.size+"</color> 人，开始序号为<color=blue> "+this.startIdx+" </color>",this.generatePool();break;case r.Rolling:this.sizeInput.maxLength=0,this.btnStart.interactable=!1}},reset:function(){this.state=r.Setup,this.size=null,this.startIdx=null,this.sizeInput.string="",this.startInput.string="",this.winner=-1,this.numberMng.reset();for(var t=this.winnerLayout.node.children,i=0;i<t.length;++i)t[i].destroy()}}),cc._RFpop()},{NumberManager:"NumberManager"}],NumberDisplay:[function(t,i,e){"use strict";function n(t,i){return t=Math.ceil(t),i=Math.floor(i),Math.floor(Math.random()*(i-t))+t}cc._RFpush(i,"0a686UOefBFtaPfbgH4a+6d","NumberDisplay"),cc.Class({"extends":cc.Component,properties:{label:cc.Label,interval:0},onLoad:function(){this.label.string="0"},startRolling:function(){this.schedule(this.updateDisplay,this.interval,this)},updateDisplay:function(){var t=n(0,10);t===this.lastNum&&(t+=1,t>=10&&(t=0)),this.label.string=t.toString(),this.lastNum=t},stopRolling:function(){this.unschedule(this.updateDisplay,this)},showNumber:function(t){return this.stopRolling(),t>=10?void cc.log("invalid result!"):void(this.label.string=Math.floor(t).toString())}}),cc._RFpop()},{}],NumberManager:[function(t,i,e){"use strict";cc._RFpush(i,"f157dcnP69HcIcCwcaMJA4Q","NumberManager"),cc.Class({"extends":cc.Component,properties:{numberPrefab:cc.Prefab,digits:0,delayPerDigits:0,layout:cc.Layout},init:function(t){this.numbers=[],this.game=t;for(var i=0;i<this.digits;++i){var e=cc.instantiate(this.numberPrefab);this.numbers.push(e.getComponent("NumberDisplay")),this.layout.node.addChild(e),e.setPositionY=0}},startRolling:function(){for(var t=0;t<this.digits;++t)this.startRollSingleDigit(t)},startRollSingleDigit:function(t){this.scheduleOnce(function(){this.numbers[t].startRolling()}.bind(this),this.delayPerDigits*(t+1))},showResult:function(t){for(var i=t.toString(),e=this.digits-1;e>=0;--e){var n="";n=e<i.length?i[i.length-e-1]:"0",this.showResultSingleDigit(e,n)}},showResultSingleDigit:function(t,i){this.scheduleOnce(function(){this.numbers[t].showNumber(i),0===t&&this.game.finishResult()}.bind(this),this.delayPerDigits*(this.digits-t))},reset:function(){for(var t=0;t<this.digits;++t)this.numbers[t].showNumber(0)}}),cc._RFpop()},{}],WinnerLabel:[function(t,i,e){"use strict";cc._RFpush(i,"e398fCiPK9Fd4uCVUUMc0eE","WinnerLabel"),cc.Class({"extends":cc.Component,properties:{anim:cc.Animation,label:cc.Label},init:function(t){this.label.string=t.toString(),this.anim.play("appear")}}),cc._RFpop()},{}]},{},["NumberDisplay","Game","WinnerLabel","NumberManager"]);